!function(l){"use strict";var k="ht",Q=l[k],W=function(){return document},A=function(){return W().body},g=function(i,U,Y){i.style.setProperty(U,Y,null)},M=function(k){return W().createElement(k)},D=function(){return M("div")},C=function(){var E=M("canvas");return E},o=function(Z,I){g(Z,"-webkit-transform",I),g(Z,"-ms-transform",I),g(Z,"transform",I)},B=function(G,R){g(G,"-webkit-transform-origin",R),g(G,"-ms-transform-origin",R),g(G,"transform-origin",R)},h=function(W,S){W.appendChild(S)},c=function(J,s){J.removeChild(s)},E=l.parseInt,x=Q.Default,N=x.getInternal(),L=Math.PI,t="white-space",z="visibility",U="left",F="top",R="width",m="height",a="position",J="display",v="z-index",n="px",O="0 0",G="absolute",$="visible",w="hidden",s="none",f="block",I="nowrap",K="rgba(0, 0, 0, 0.005)";x.setImage("node_dragger","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAN9JREFUeNrsV9sNhDAMKyzQVdgARmGzrMJNUFZhAh6nfkVcG9PQgHSR8lEksJs6pnGuLCimSRzAa0yyBK9O4gy8GokU+O0kJOAwiQYg0LP1xNYDW3+0CfBYNb7VOuN4LAGpiOaYUhFDas9F2NPHDELNENJqaHgBgSQJ3ufakfQJqckERcOiK+Ae1FGWBNKGh9oX5WPpLpdNYfffijbsxTHh7VKP7388n1g1h7OKUoUuyGpJakQEuhwkZAKcDXVOdWcrOrL/feBVBHI/q8fcjE1nA9PpyHQ+NJ2Qi8A3AQYAOtS27fCoRY0AAAAASUVORK5CYII=");var p=Q.graph.GraphView.prototype,j=p._42;p.adjustHtmlNodeIndex=!0,p._42=function(y,d){if(j.call(this,y,d),this.adjustHtmlNodeIndex)for(var f=this.getDataModel()._datas._as,q=f.length,k=1,r=0;q>r;r++){var I=f[r];if(I instanceof X){var J=this.getDataUI(I);g(J.$2f,v,k+""),g(J.$3f,v,k+1+""),k+=2}}};var b=Q.HtmlNodeUI=function(m,d){var A=this;b.superClass.constructor.call(A,m,d);var L=A.$2f=D(),S=A.$3f=C();g(L,a,G),g(L,z,w),g(L,t,I),S.draggable=!1,g(S,a,G),g(S,J,s),B(S,O),L.addEventListener("change",function(F){var Z=F.target,s=Z.bind||Z.getAttribute("bind"),t=Z.type&&"checkbox"===Z.type?Z.checked:Z.value,j=d.getContext();s&&j&&(j[s]=t,A.$4f=JSON.stringify(j))}),["mousedown","touchstart","keydown","mousewheel","DOMMouseScroll"].forEach(function(o){L.addEventListener(o,this.$9f.bind(this))},A)};x.def(b,N.ui().NodeUI,{_visible:!0,$11f:function(){var z=this,w=z.$3f,u=z._data,s=u.getDraggerImageWidth(),d=u.getDraggerImageHeight(),c=u.getDraggerImage(),o=N.initContext(w);o.beginPath(),N.setCanvas(w,s,d),N.translateAndScale(o,0,0,1),o.clearRect(0,0,s,d),x.drawImage(o,x.getImage(c),0,0,s,d),o.restore()},_80o:function(_){b.superClass._80o.call(this,_);var c=this,i=c._data,y=i._padding,H=2*y,S=c.$2f,B=c.$3f,u=c.gv,N=u.getZoom(),C=u.getTranslateX(),M=u.getTranslateY(),A=u.getView(),j=c._83o,r=i._width,l=i._height,Q=j.position,p=j.rotation,O=(r-H)/i.$5f*N,q=(l-H)/i.$6f*N,e=c._html,P=i._html,Y=i.getHtmlType();if("html"===Y){var Z=i.getContext()||{},t=c.$4f,x=i.$10f,V=JSON.stringify(Z);e&&t&&e===P&&t===V||(c.$4f=V,c._html=P,S.innerHTML=x?x(Z):P)}else if(null!=Y){var d=i.getHtml();"ht"===Y&&(d=d.getView()),e&&e===d&&S.contains(e)||(c._html=d,S.innerHTML="",h(S,d))}if(!S.parentNode){var k=u.$1f;if(!k){var I=D();g(I,a,G),g(I,v,"0"),k=u.$1f=I;var W=u._canvas.nextSibling;W?A.insertBefore(I,W):h(A,I)}h(k,S),h(k,B),i.onContentInitialized&&i.onContentInitialized(S)}if(i._scalable){var X=i.$5f,T=i.$6f;o(S,"rotate("+180*(p/L)+"deg) scale("+O+","+q+")"),g(S,R,""),g(S,m,""),g(S,U,(Q.x-X/N/2)*N+C+n),g(S,F,(Q.y-T/N/2)*N+M+n)}else{var lb=E(S.style.width),ge=E(S.style.height),yr=E((r-H)*N),Fg=E((l-H)*N),Gq="100%",yf=S.children[0];g(yf,R,Gq),g(yf,m,Gq),(lb!==yr||ge!==Fg)&&(g(S,R,yr+n),g(S,m,Fg+n),"ht"===Y&&P.invalidate()),o(S,"rotate("+180*(p/L)+"deg)"),g(S,U,(Q.x-yr/N/2)*N+C+n),g(S,F,(Q.y-Fg/N/2)*N+M+n)}var Zq=c.dragRect;u.isMovable(i)&&u.isSelected(i)&&Zq?(_.save(),_.fillStyle=K,_.fillRect(Zq.x,Zq.y,Zq.width,Zq.height),_.restore(),g(B,U,Zq.x*N+C+n),g(B,F,Zq.y*N+M+n),o(B,"scale("+N+","+N+")"),g(B,J,f),c.$11f()):g(B,J,s),g(S,z,this._visible?$:w)},dispose:function(){var b=this.gv.$1f;this.$2f.parentNode===b&&b.removeChild(this.$2f),this.$3f.parentNode===b&&b.removeChild(this.$3f)},_84o:function(i){this._visible=i,g(this.$2f,z,i?$:w),g(this.$3f,J,i?f:s)},_3O:function(){var O=this,t=O.gv,U=O._data;b.superClass._3O.call(O);var j=U.getRect();t.isEditable(U)&&(O.dragRect={x:j.x+j.width+U._padding,y:j.y+10,width:U.getDraggerImageWidth(),height:U.getDraggerImageHeight()},O._68o(O.dragRect))},rectIntersects:function(s){var V=this._79o();return Q.Default.intersection(V,s)?!0:void 0},$9f:function(m){var Q=this.gv,h=this._data;Q.sm().contains(h)&&m.stopPropagation()}});var X=Q.HtmlNode=function(){X.superClass.constructor.call(this)};Q.Default.def(X,Q.Node,{ms_ac:["html","context","scalable","padding","draggerImage","draggerImageWidth","draggerImageHeight"],_padding:Q.Default.isTouchable?12:6,_image:null,_scalable:!0,_draggerImage:"node_dragger",_draggerImageWidth:20,_draggerImageHeight:20,setHtml:function(M){var j=this,T=j._html;j._html=M,"html"===j.getHtmlType()&&"Handlebars"in l&&(j.$10f=Handlebars.compile(M)),j.$13f(),j.fp("html",T,M)},setContext:function(d){var E=this,B=E._context;E._context=d,E.fp("context",B,d),E.$13f()},setScalable:function(D){var j=this,i=j._scalable;j._scalable=D,j.fp("scalable",i,D),j.$13f()},getHtmlType:function(){var p=this._html;return p?"string"==typeof p?"html":p.getView?"ht":"dom":null},$13f:function(){var r=this,o=r._html,s=r.$10f;if(o){var J=D(),l=!1,C=r.getHtmlType();if(g(J,a,G),g(J,t,I),g(J,z,w),"html"===C?(J.innerHTML=s?s(r.getContext()||{}):o,l=!0):"ht"===C?(h(J,o.getView()),l=!0):"dom"===C&&(h(J,o),l=!0),l){var N=2*r._padding;h(A(),J),r.$5f=J.scrollWidth,r.$6f=J.scrollHeight,r._width=r.$5f+N,r._height=r.$6f+N,r._originWidth=r._width,r._originHeight=r._height,c(A(),J)}}},getUIClass:function(){return Q.HtmlNodeUI}})}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);