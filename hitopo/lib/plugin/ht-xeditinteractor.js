!function(j,b,v){"use strict";var S="ht",Q=j[S],s=Q.Default,i=Q.graph,T=s.getInternal(),O=T.ui(),d=O.NodeUI.prototype,H=O.ShapeUI.prototype,n=i.GraphView,V=n.prototype,B=O.EdgeUI.prototype,U=Q.Node,W=Q.Shape,$=Q.Edge,K=Q.Group,f=s.isTouchable,D=s.preventDefault,M=j.setTimeout,g=s.grow,L=s.isDragging,R=s.getDistance,m=null,z=Q.List,F="undefined"!=typeof Float32Array?Float32Array:Array,A=Math,C=A.PI,e="Crossing",y="No Crossing",l=C/2,J=2*C,t=A.atan2,o=A.sqrt,Y=A.pow,p=A.sin,w=A.cos,N=A.min,X=A.max,Z=A.abs,k=A.ceil,x=A.round,E=s.unionPoint,h=s.unionRect,P=s.containsPoint,a=s.clone,u="rgb(52, 152, 219)",c="red",I={northwest:0,north:1,northeast:2,west:7,east:3,southwest:6,south:5,southeast:4},q={width:400,height:100,comps:[{type:"shape",points:{func:function(){for(var t=[10,8,162,36,314,37,269,2,398,49,268,98,314,58,161,60,9,91,103,49,10,8],B=0;B<t.length;B++){var P=t[B];P=0===B%2?P/400*q.width:P/100*q.height,t[B]=P}return q.width>120&&(t[4]=q.width-26,t[6]=q.width-40,t[10]=q.width-40,t[12]=q.width-26,t[18]=33),t}},segments:[1,3,2,2,2,2,3,2,2],background:"white",gradient:"linear.east",gradientColor:"red"}]},G={width:300,height:300,comps:[{type:"circle",rect:[20,0,120,120],background:u,rotation:.61},{type:"circle",rect:[200,120,70,70],background:u,rotation:.61},{type:"circle",rect:[200,220,70,70],background:u,rotation:.61},{type:"shape",points:[80,60,80,155,200,155],borderWidth:20,borderColor:u},{type:"shape",points:[80,60,80,255,200,255],borderWidth:20,borderColor:u}]},r={width:300,height:300,comps:[{type:"shape",points:[114,239,115,106,112,73,149,73,149,73,175,73,177,105,179,261,178,302,147,307,98,308,83,307,72,276,73,260,72,81,74,29,115,21,191,21,221,22,224,53,223,238],segments:[1,2,3,2,3,2,3,2,4,2,3,2,3,2],borderWidth:20,borderColor:c,rotation:.61}]},_={width:300,height:300,comps:[{type:"circle",rect:[210,0,90,90],background:u},{type:"circle",rect:[0,210,90,90],background:u},{type:"shape",points:[255,45,45,255],borderWidth:20,borderColor:u}]},qi={width:300,height:300,comps:[{type:"shape",points:[20,20,280,280],borderWidth:30,borderColor:c},{type:"shape",points:[280,20,20,280],borderWidth:30,borderColor:c}]},Vk={width:300,height:300,comps:[{type:"shape",points:[270,30,30,150,270,270],borderWidth:40,borderColor:u}]},Ml={width:300,height:300,comps:[{type:"shape",points:[30,30,270,150,30,270],borderWidth:40,borderColor:c}]},fr={width:300,height:300,comps:[{type:"rect",rect:[125.58,52.76,40,231.96],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"rect",rect:[27.87,61.06,150,30],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000",rotation:5.5},{type:"rect",rect:[113.36,61,150,30],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000",rotation:.79}]},ah={width:300,height:300,author:"",note:"",comps:[{type:"rect",rect:[135.15,38.76,28.63,82.84],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"triangle",rect:[94.69,2.35,110,44.77],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"rect",rect:[31.71,115.72,240,15],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"rect",rect:[31.71,167.62,240,15],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"rect",rect:[135.15,177.33,28.63,82.84],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"triangle",rect:[94.69,251.39,110,44.77],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000",rotation:3.14}]},wj=function(J){var O=J.touches[0];return O?O:J.changedTouches[0]},kn=function(S,i,m,n){return t(n-i,m-S)},Yd=function(e,E){return{x:e.x*E,y:e.y*E}},ar=function(h,b){h.each(function(X){return h.isSelected(X)?b(X):void 0})},hi=function(e,Y){e.reverseEach(function(f){return e.isSelected(f)?Y(f):void 0})},xc=function(n,m,e){var p,X,U,v,Z,h=this,t=m,B=h.gv;if(n instanceof W){U=n.getSegments();var L=B.getDataUI(n);Z=L._55O.$15l,U&&U.size()||(U=kd(Z)),n.isClosePath()&&U.indexOf(5)<0&&(U=new z(U._as),U.add(5)),p=Yb(n,L,t),X=Z[p]}else{var S=B.getDataUI(n);Z=Vp(S,n.s("edge.points")),U=n.s("edge.segments"),U&&U.size()||(U=kd(Z)),Z=Z._as,p=Yb(n,S,t),X=Z[p]}if(U&&(v=U.get(t)),2===v||1===v||5===v){var J=Z[p+1];5===v&&(J=Z[0]);var C=dk(X,e,J);return C}return e},tl=function(D,p,G,x){var Z=p/2,T=G/2,f=Cr(D,-Z,-T,x),V=Cr(D,Z,-T,x),h=Cr(D,-Z,T,x),K=Cr(D,Z,T,x),v=Cr(D,0,-T,x),X=Cr(D,Z,0,x),Y=Cr(D,0,T,x),$=Cr(D,-Z,0,x);return[f,V,h,K,v,X,Y,$]},dk=function(v,b,x){var O={x:b.x-v.x,y:b.y-v.y},L={x:x.x-v.x,y:x.y-v.y},r=o(Y(x.x-v.x,2)+Y(x.y-v.y,2)),G={x:L.x/r,y:L.y/r},_=O.x*G.x+O.y*G.y,N={x:G.x*_,y:G.y*_};return{x:v.x+N.x,y:v.y+N.y}},Cr=function(W,j,S,C){var J=w(C)*j-p(C)*S,P=p(C)*j+w(C)*S;return W?{x:W.x+J,y:W.y+P}:{x:J,y:P}},Uf=function(E,l){return l>2*E?E:l/2},Oj=function(c,d,A,o){var O=R(c,d);return A=o?N(A,O):Uf(A,O),O?A/=O:A=0,{x:c.x+(d.x-c.x)*A,y:c.y+(d.y-c.y)*A}},me=function(k,_){var U,Y,R=k.gv,t=k._data,n=t._40I,x=t._41I,f=t.s("edge.offset"),o=t.s("edge.source.position"),D=t.s("edge.target.position"),V=t.s("edge.source.offset.x"),d=t.s("edge.source.offset.y"),Q=t.s("edge.target.offset.x"),K=t.s("edge.target.offset.y"),a=t.s("edge.source.anchor.x"),u=t.s("edge.source.anchor.y"),E=t.s("edge.target.anchor.x"),H=t.s("edge.target.anchor.y");if(_?(U=T.getEdgeAgentPosition(R,n,o,V,d,a,u),Y=T.getEdgeAgentPosition(R,x,D,Q,K,E,H)):(U=T.getEdgeAgentPosition(R,n,o,0,0,a,u),Y=T.getEdgeAgentPosition(R,x,D,0,0,E,H)),"points"===t.s("edge.type")&&f&&!t.s("edge.center")&&U){var e=t.s("edge.points")||new z,B=e.size(),W=Oj(U,B?e.get(0):Y,f,B),i=Oj(Y,B?e.get(B-1):U,f,B);U=W,Y=i}return[U,Y]},Vp=function(n,q,u){var E=n._78o,t=n._data,L=t.s("edge.type"),r=[E.sourcePoint,E.targetPoint];return"points"===L?u&&(r=me(n)):r=E.center?L?u?me(n):me(n,!0):u?me(n):[E.c1,E.c2]:u?me(n):me(n,!0),q=new z(q?q._as:m),q.add(r[0],0),q.add(r[1]),q},Ff=function(v){return v=new z(v._as),v.removeAt(0),v.removeAt(v.size()-1),v},kd=function(i){i._as||(i=new z(i));var d=new z;d.add(1);for(var e=1;e<i.size();e++)d.add(2);return d},li=function(M,e){return{x:(M.x+e.x)/2,y:(M.y+e.y)/2}},ho=function(_,r){return{x:_.x+1*(r.x-_.x)/4,y:_.y+1*(r.y-_.y)/4}},Xb=function(E,P){return{x:E.x+3*(P.x-E.x)/4,y:E.y+3*(P.y-E.y)/4}},kl=function(G,n,x,v){var Y=n.x+n.width/2,A=n.y+n.height/2,P=o(Y*Y+A*A),K=t(A,Y)+x;return{x:v.x+P*w(K),y:v.y+P*p(K)}},Tr=V.validateImpl,Bf=V.isRectEditable,Pr=V.isPointEditable,vm=V._42,Ih=H._79o,gc=B._79o,Yc=H._48O,jg=H._47O,Gi=d._48O,Ap=d._80o,ni=H._80o,aq=d.getSelectWidth,Wr=d._47O,Ch=B._47O,Th=V.isEditable,Go=["northwest","north","northeast","east","southeast","south","southwest","west"],rc=function(Y,a,X,S,G,J,h,M,b,e){var q=Y.x,x=Y.y,K=Y.width,t=Y.height,T={x:q+K/2,y:x+t/2};S=S||0,a=Cr(T,a.x-T.x,a.y-T.y,-S),h&&!M&&(a.x+=b,a.y+=e);var i=.01;if("northwest"===X?(a.x+G>q+K-i&&(a.x=q+K-G-i),a.y+G>x+t-i&&(a.y=x+t-G-i),Y=E(a,{x:q+K,y:x+t})):"north"===X?(a.y+G>x+t-i&&(a.y=x+t-G-i),Y=E({x:q,y:a.y},{x:q+K,y:x+t})):"northeast"===X?(a.x<q+G+i&&(a.x=q+G+i),a.y+G>x+t-i&&(a.y=x+t-G-i),Y=E({x:q,y:a.y},{x:a.x,y:x+t})):"west"===X?(a.x+G>q+K-i&&(a.x=q+K-G-i),Y=E({x:a.x,y:x},{x:q+K,y:x+t})):"east"===X?(a.x<q+G+i&&(a.x=q+G+i),Y=E({x:q,y:x},{x:a.x,y:x+t})):"southwest"===X?(a.x+G>q+K-i&&(a.x=q+K-G-i),a.y<x+G+i&&(a.y=x+G+i),Y=E({x:a.x,y:x},{x:q+K,y:a.y})):"south"===X?(a.y<x+G+i&&(a.y=x+G+i),Y=E({x:q,y:x},{x:q+K,y:a.y})):"southeast"===X&&(a.x<q+G+i&&(a.x=q+G+i),a.y<x+G+i&&(a.y=x+G+i),Y=E({x:q,y:x},a)),"keepRatio"===J&&(!h&&M||h&&!M)&&("northeast"===X||"southeast"===X||"northwest"===X||"southwest"===X)){var O=Y.width,p=Y.height,U=O/K,f=p/t,H=N(U,f);Y.width=K*H,Y.height=t*H,"northeast"===X?Y.y=x+(t-Y.height):"northwest"===X?(Y.y=x+(t-Y.height),Y.x=q+(K-Y.width)):"southwest"===X&&(Y.x=q+(K-Y.width))}Y.x-=T.x,Y.y-=T.y;var $=kl(m,Y,S,T);return Y.x=$.x-Y.width/2,Y.y=$.y-Y.height/2,Y},Hq=function(R,p,m,d){var X=R.getRotation(),S=p,D=S.x,w=S.y,V=S.width,j=S.height,z={x:D+S.width/2,y:w+S.height/2};d=Cr(z,d.x-z.x,d.y-z.y,-X),"northwest"===m?S=E(d,{x:D+V,y:w+j}):"north"===m?S=E({x:D,y:d.y},{x:D+V,y:w+j}):"northeast"===m?S=E({x:D,y:d.y},{x:d.x,y:w+j}):"west"===m?S=E({x:d.x,y:w},{x:D+V,y:w+j}):"east"===m?S=E({x:D,y:w},{x:d.x,y:w+j}):"southwest"===m?S=E({x:d.x,y:w},{x:D+V,y:d.y}):"south"===m?S=E({x:D,y:w},{x:D+V,y:d.y}):"southeast"===m&&(S=E({x:D,y:w},d)),R.setRect(S),S.x-=z.x,S.y-=z.y;var c=kl(R,S,X,z);R.p(c.x,c.y)},hh=function(v,N,y,I,U,e,q,i){var Q=m;e?(Q=Cr(m,U.x-N.x,U.y-N.y,-y),Q.x-=q.x,Q.y-=q.y):Q=Cr(m,U.x-N.x,U.y-N.y,0);var S={x:N.x+Q.x,y:N.y+Q.y};i&&(S=i(S.x,S.y)),S.e=v.getPoints().get(I).e,v.setPoint(I,S);var M=v.getWidth(),r=v.getHeight(),X=v.p().x-M/2,L=v.p().y-r/2;X-=N.x,L-=N.y;var D=kl(v,{x:X,y:L,width:M,height:r},y,N);v.p(D.x,D.y)},Yb=function(i,V,D){var l,e;if(i instanceof W?(l=i.getPoints(),e=i.getSegments()):i instanceof $&&"points"===i.s("edge.type")&&(l=i.s("edge.points"),e=i.s("edge.segments"),l=Vp(V,l)),e&&e.size()||(e=kd(l)),i instanceof W&&i.isClosePath()&&e.indexOf(5)<0&&(e=new z(e._as),e.add(5)),e)for(var I=-1,o=0;o<e.size();o++){if(o===D)return I;var u=e.get(o);1===u?I+=1:2===u?I+=1:3===u?I+=2:4===u&&(I+=3)}},Xm=function(b,B,w){var f,D;if(b instanceof W?(f=b.getPoints(),D=b.getSegments()):b instanceof $&&"points"===b.s("edge.type")&&(f=b.s("edge.points"),D=b.s("edge.segments"),f=Vp(B,f)),D&&D.size()||(D=kd(f)),D)for(var d=-1,x=0;x<D.size();x++){var l=D.get(x);if(1===l?d+=1:2===l?d+=1:3===l?d+=2:4===l&&(d+=3),d===w)return x}},ki=function(P,$){var f=[P[0]-$[0],P[1]-$[1],P[2]-$[2]];return f},Qh=function(){var o=new F(16);return o[0]=1,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=1,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[10]=1,o[11]=0,o[12]=0,o[13]=0,o[14]=0,o[15]=1,o},cg=function(v,p){var w=v[0],U=v[1],B=v[2];return v[0]=p[0]*w+p[4]*U+p[8]*B+p[12],v[1]=p[1]*w+p[5]*U+p[9]*B+p[13],v[2]=p[2]*w+p[6]*U+p[10]*B+p[14],v},mq=function(H,D){if(D){var P=p(D),x=w(D),X=H[0],y=H[1],L=H[2],f=H[3],v=H[8],b=H[9],c=H[10],S=H[11];H[0]=X*x-v*P,H[1]=y*x-b*P,H[2]=L*x-c*P,H[3]=f*x-S*P,H[8]=X*P+v*x,H[9]=y*P+b*x,H[10]=L*P+c*x,H[11]=f*P+S*x}},ss=function(b,l){for(var x=b.s("grid.row.count"),a=b.s("grid.column.count"),M=0;x>M;M++)for(var O=0;a>O;O++){var B=b.getCellRect(M,O);if(P(B,l))return{rowIndex:M,columnIndex:O,rect:B,grid:b}}return null},vj=function(v,p,I,Y,b,H){var e={},h=I-v,E=Y-p,C=A.sqrt(h*h+E*E),X=h/C,m=E/C,K=(-v+b)*X+(-p+H)*m;return 0>=K?(e.x=v,e.y=p):K>=C?(e.x=I,e.y=Y):(e.x=v+K*X,e.y=p+K*m),h=b-e.x,E=H-e.y,e.z=A.sqrt(h*h+E*E),e},_e=function(Q,B){var j,J,b,r,A,S,x,t,X=Q.getPoints(),_=Q.getSegments(),T=Q.p(),e=Q.getRotation();if(!_||!(_.indexOf(3)>0||_.indexOf(4)>0)){for(t=0;t<=X.size()-1;t++)if(t===X.size()-1?(A=X.get(0),r=X.get(t)):(r=X.get(t),A=X.get(t+1)),r=Cr(T,r.x-T.x,r.y-T.y,e),A=Cr(T,A.x-T.x,A.y-T.y,e),S=vj(r.x,r.y,A.x,A.y,B.x,B.y),x=S.z,x<(Q.s("shape.border.width")||10)){J=r,b=A,j=t;break}if(j!=m){var K=vj(J.x,J.y,b.x,b.y,B.x,B.y),L=R(J,K);return{attachIndex:j,attachOffset:L}}}},hr=function(W){for(var h=W._data,l=h.p(),e=h.getRotation(),_=h.getPoints(),g=m,t=[],F=0;F<_.size();F++)g=_.get(F),t.push(Cr(l,g.x-l.x,g.y-l.y,e));W._55O.$15l=t};s.setImage("xeditinteractor_parentIcon",G),s.setImage("xeditinteractor_hostIcon",r),s.setImage("xeditinteractor_edgeIcon",_),s.setImage("xeditinteractor_removeIcon",qi),s.setImage("xeditinteractor_sourceIcon",Vk),s.setImage("xeditinteractor_targetIcon",Ml),s.setImage("xeditinteractor_elevationIcon",fr),s.setImage("xeditinteractor_tallIcon",ah),V._editPointSize=f?24:9,V._edgeHelpers=["parent","remove","source","target"],V._leftTopHelpers=["parent"],V._rightTopHelpers=["host"],V._leftBottomHelpers=["edge"],V._rightBottomHelpers=["remove"],Go=Go.concat(Go).concat(Go),B._79o=function(){var K=this,F=K.gv,d=F.getZoom(),b=F._editInteractor,U=gc.call(K);if(!U)return null;var m=me(K,!0),w=m[0],j=m[1],z={x:U.x,y:U.y,width:U.width,height:U.height},S=E(w,j);if(b instanceof i.XEditInteractor){z=h(z,S);var k=K._55O,q=F.getEditPointSize()/d+2,o=0;k&&k._43O&&(o+=q/2,g(z,o))}return z},B._47O=function(m){var P=this,l=P.gv,U=l._editInteractor;U instanceof i.XEditInteractor||Ch.call(P,m)},B.rectIntersects=function(z){var u=this,V=u._data,J=u.gv,d=J.getZoom(),g=u._55O,Y=J._editInteractor;if(Y instanceof i.XEditInteractor&&J.isEditable(V)&&g&&g._43O&&"points"===V.s("edge.type")){var B=V.s("edge.points"),k=V.s("edge.segments");B=Vp(u,B),k&&k.size()||(k=kd(B)),B=B._as;var N=!1,F=f?5:1,K=z.x+F,X=z.y+F,E={x:K,y:X};if(Y._edge===V&&Y._hoverSegmentIndex>=0){var w=J._editInteractor._hoverSegmentIndex,b=k.get(w),t=Yb(V,u,w),h=m;if(t!=m&&t>=0){var c=B[t],R=J.getSegmentHoverWidth()/d;if(2===b||1===b){var n=B[t+1];h=uo(new ps(c.x,c.y),new ps(n.x,n.y),new ps(E.x-R,E.y-R),new ps(E.x+2*R,E.y+2*R)),h.$62l===e&&(N=!0)}else if(3===b){var C=B[t+1],n=B[t+2];h=Rl(new ps(c.x,c.y),new ps(C.x,C.y),new ps(n.x,n.y),new ps(E.x-R,E.y-R),new ps(E.x+2*R,E.y+2*R)),h.$62l===e&&(N=!0)}else if(4===b){var W=B[t+1],$=B[t+2];n=B[t+3],h=kj(new ps(c.x,c.y),new ps(W.x,W.y),new ps($.x,$.y),new ps(n.x,n.y),new ps(E.x-R,E.y-R),new ps(E.x+2*R,E.y+2*R)),h.$62l===e&&(N=!0)}}}if(N)return!0}return m},H._47O=function($){var f=this,m=f.gv,r=m._editInteractor;r instanceof i.XEditInteractor||jg.call(f,$)},H.rectIntersects=function(n){var P=this,M=P._data,G=P.gv,r=G.getZoom(),Y=P._55O,X=G._editInteractor;if(X instanceof i.XEditInteractor&&G.isEditable(M)&&Y&&Y._43O){var O=Y.$15l,o=!1,g=f?5:1,a=n.x+g,E=n.y+g,N={x:a,y:E};if(O&&O.length===M.getPoints().size()||(hr(P),O=Y.$15l),X._shape===M&&X._hoverSegmentIndex>=0){var J=M.getSegments();J&&J.size()||(J=kd(O));var S=G._editInteractor._hoverSegmentIndex,T=J.get(S),s=Yb(M,P,S),Q=m;if(s!=m&&s>=0){var p=O[s],I=G.getSegmentHoverWidth()/r;if(2===T||1===T){var B=O[s+1];Q=uo(new ps(p.x,p.y),new ps(B.x,B.y),new ps(N.x-I,N.y-I),new ps(N.x+2*I,N.y+2*I)),Q.$62l===e&&(o=!0)}else if(3===T){var t=O[s+1],B=O[s+2];Q=Rl(new ps(p.x,p.y),new ps(t.x,t.y),new ps(B.x,B.y),new ps(N.x-I,N.y-I),new ps(N.x+2*I,N.y+2*I)),Q.$62l===e&&(o=!0)}else if(4===T){var k=O[s+1],R=O[s+2];B=O[s+3],Q=kj(new ps(p.x,p.y),new ps(k.x,k.y),new ps(R.x,R.y),new ps(B.x,B.y),new ps(N.x-I,N.y-I),new ps(N.x+2*I,N.y+2*I)),Q.$62l===e&&(o=!0)}}}if(o)return!0}return m},H._48O=function(){var y=this,D=y.gv,H=D._editInteractor;H instanceof i.XEditInteractor?(d._48O.call(y),y._55O._43O&&hr(y)):Yc.call(y)},H._79o=function(){var h=this,d=h.gv,w=d.getZoom(),t=d._editInteractor,Z=Ih.call(h);if(Z){var j={x:Z.x,y:Z.y,width:Z.width,height:Z.height};if(t instanceof i.XEditInteractor){var J=h._55O,o=d.getEditPointSize()/w+2,y=0;J&&J._43O&&(y+=o/2,g(j,y))}return j}},d._47O=function($){var t=this,_=t.gv,O=_._editInteractor;if(O instanceof i.XEditInteractor);else{var K=t._55O;K&&K._98o&&Wr.call(t,$)}},d.getSelectWidth=function(){var I=this,Q=I.gv,O=Q._editInteractor,f=I._data;return Q.isEditable(f)&&O instanceof i.XEditInteractor?0:aq.call(I)},d._80o=function(N){var t=this,U=t.gv._editInteractor;if(Ap.call(t,N),U&&U._debug){N.save(),N.beginPath(),N.lineWidth=1,N.strokeStyle="green";var K=t._79o();K&&(N.rect(K.x,K.y,K.width,K.height),N.stroke()),N.restore()}},H._80o=function(a){var J=this,X=J.gv._editInteractor;if(ni.call(J,a),X&&X._debug){a.save(),a.beginPath(),a.lineWidth=1,a.strokeStyle="green";var z=J._79o();a.rect(z.x,z.y,z.width,z.height),a.stroke(),a.restore()}},d._48O=function(){var M=this,Q=M.gv,b=M._data,U=Q._editInteractor,w=M._55O,k=b.p(),Z=b.getRotation();if(U instanceof i.XEditInteractor){if(w._42O){var u=tl(k,b.getWidth(),b.getHeight(),Z),S=u[0],f=u[1],p=u[2],m=u[3],d=u[4],L=u[5],G=u[6],X=u[7];w.$45l=[S,d,f,L,m,G,p,X]}}else Gi.call(M)},V.getResizeMode=function(){return this.$25l||"normal"},V.setResizeMode=function(J){var P=this.$25l;this.$25l=J,this.fp("resizeMode",P,J)},V.getSnapAngle=function(){return this.$26l||Math.PI/36},V.setSnapAngle=function(x){var i=this.$26l;this.$26l=x,this.fp("snapAngle",i,x)},V.getSnapSpacing=function(){return this.$27l},V.setSnapSpacing=function(x){var t=this.$27l;this.$27l=x,this.fp("snapSpacing",t,x)},V.getPointSnapSpacing=function(){return this._pointSnapSpacing},V.setPointSnapSpacing=function(D){var V=this._pointSnapSpacing;this._pointSnapSpacing=D,this.fp("pointSnapSpacing",V,D)},V.setHelperEditableFunc=function(q){var t=this._helperEditableFunc;this._helperEditableFunc=q,this.fp("helperEditableFunc",t,q)},V.getHelperEditableFunc=function(){return this._helperEditableFunc},V.setLeftTopHelpers=function(N){var a=this._leftTopHelpers;this._leftTopHelpers=N,this.fp("leftTopHelpers",a,N)},V.getLeftTopHelpers=function(){return this._leftTopHelpers},V.setLeftTopHelpersAlign=function($){var z=this._leftTopHelpersAlign;this._leftTopHelpersAlign=$,this.fp("leftTopHelpersAlign",z,$)},V.getLeftTopHelpersAlign=function(){return this._leftTopHelpersAlign},V.setRightTopHelpers=function(B){var y=this._rightTopHelpers;this._rightTopHelpers=B,this.fp("rightTopHelpers",y,B)},V.getRightTopHelpers=function(){return this._rightTopHelpers},V.setRightTopHelpersAlign=function(B){var G=this._rightTopHelpersAlign;this._rightTopHelpersAlign=B,this.fp("rightTopHelpersAlign",G,B)},V.getRightTopHelpersAlign=function(){return this._rightTopHelpersAlign},V.setLeftBottomHelpers=function(L){var n=this._leftBottomHelpers;this._leftBottomHelpers=L,this.fp("leftBottomHelpers",n,L)},V.getLeftBottomHelpers=function(){return this._leftBottomHelpers},V.setLeftBottomHelpersAlign=function(w){var v=this._leftBottomHelpersAlign;this._leftBottomHelpersAlign=w,this.fp("leftBottomHelpersAlign",v,w)},V.getLeftBottomHelpersAlign=function(){return this._leftBottomHelpersAlign},V.setRightBottomHelpers=function(D){var M=this._rightBottomHelpers;this._rightBottomHelpers=D,this.fp("rightBottomHelpers",M,D)},V.getRightBottomHelpers=function(){return this._rightBottomHelpers},V.setRightBottomHelpersAlign=function(T){var D=this._rightBottomHelpersAlign;this._rightBottomHelpersAlign=T,this.fp("rightBottomHelpersAlign",D,T)},V.getRightBottomHelpersAlign=function(){return this._rightBottomHelpersAlign},V.setEdgeHelpers=function(W){var l=this._edgeHelpers;this._edgeHelpers=W,this.fp("edgeHelpers",l,W)},V.getEdgeHelpers=function(){return this._edgeHelpers},V.isHelperEditable=function(i,W){return i instanceof $&&("host"===W||"edge"===W||"elevation"===W||"tall"===W)?!1:i instanceof U&&("source"===W||"target"===W)?!1:"pointElevation"===W?this._helperEditableFunc?this._helperEditableFunc(i,W):!1:this._helperEditableFunc?this._helperEditableFunc(i,W):!0},V.getEditHelperSize=function(){return this._editHelperSize||(f?28:16)},V.setEditHelperSize=function(B){var D=this._editHelperSize;this._editHelperSize=B,this.fp("editHelperSize",D,B)},V.getEditRectBorderColor=function(){return this.$28l||"rgb(0, 168, 255)"},V.setEditRectBorderColor=function(N){var E=this.$28l;this.$28l=N,this.fp("editRectBorderColor",E,N)},V.getNodeBorderColor=function(){return this.$29l||"#1ABC9C"},V.setNodeBorderColor=function(i){var J=this.$29l;this.$29l=i,this.fp("nodeBorderColor",J,i)},V.getEditRectBorderStyle=function(){return this.$30l||"dashed"},V.setEditRectBorderStyle=function(s){var C=this.$30l;this.$30l=s,this.fp("editRectBorderStyle",C,s)},V.getControlPointBackground=function(){return this.$31l||"#ff0"},V.setControlPointBackground=function(Q){var e=this.$31l;this.$31l=Q,this.fp("controlPointBackground",e,Q)},V.getControlPointBorderColor=function(){return this.$32l||this._editPointBorderColor},V.setControlPointBorderColor=function(C){var V=this.$32l;this.$32l=C,this.fp("controlPointBorderColor",V,C)},V.getJoinPointBackground=function(){return this.$33l||this._editPointBackground},V.setJoinPointBackground=function(p){var U=this.$33l;this.$33l=p,this.fp("joinPointBackground",U,p)},V.getJoinPointBorderColor=function(){return this.$34l||this._editPointBorderColor},V.setJoinPointBorderColor=function(W){var F=this.$34l;this.$34l=W,this.fp("joinPointBorderColor",F,W)},V.getDirectionLineColor=function(){return this.$35l||"#888"},V.setDirectionLineColor=function(P){var n=this.$35l;this.$35l=P,this.fp("directionLineColor",n,P)},V.getSegmentHoverColor=function(){return this.$36l||"rgba(255, 0, 0, 0.3)"},V.setSegmentHoverColor=function(R){var O=this.$36l;this.$36l=R,this.fp("segmentHoverColor",O,R)},V.getSegmentHoverWidth=function(){return this.$22l||(f?16:8)},V.setSegmentHoverWidth=function(K){var O=this.$22l;this.$22l=K,this.fp("segmentHoverWidth",O,K)},V.getSnapPointBorderColor=function(){return this.$38l||"#f00"},V.setSnapPointBorderColor=function(n){var f=this.$38l;this.$38l=n,this.fp("snapPointBorderColor",f,n)},V.getEditRectPadding=function(){return this.$39l!=m?this.$39l:6},V.setEditRectPadding=function(z){var x=this.$39l;this.$39l=z,this.fp("editRectPading",x,z)},V.isRectEditable=function($){var H=this,d=H._editInteractor;return d instanceof i.XEditInteractor?H._rectEditableFunc?H._rectEditableFunc($):!0:Bf.call(H,$)},V.isPointEditable=function(Y){var b=this,m=b._editInteractor;return m instanceof i.XEditInteractor?b._pointEditableFunc?b._pointEditableFunc(Y):!0:Pr.call(b,Y)},V.validateImpl=function(){var s=this,b=s.$14l,H=s._editInteractor;if(b){var J=s.getWidth(),G=s.getHeight();(J!==b.clientWidth||G!==b.clientHeight)&&(H&&(H._68I=1),T.setCanvas(b,J,G),s._32I=1)}Tr.call(this)},V.isEditable=function(k){var c=Th.call(this,k),g=this._editInteractor;if(g instanceof i.XEditInteractor&&k instanceof $){if(!k.s("2d.editable"))return!1;var P=this.getEditableFunc();c=P?P(k):!0}return c},V._42=function($,I){var b=this,L=b._editInteractor;vm.call(b,$,I),L instanceof i.XEditInteractor&&L._68I&&L._42()},V.isSnapPoint=function(){return!0};var ce=function(o){arguments.length>0&&this.$58l(o)},ye=ce.prototype;ye.$58l=function(M){this.$62l=M,this.points=new Array},ye.$56l=function(J){this.points.push(J)},ye.$57l=function(K){this.points=this.points.concat(K)};var ps=function(v,B){arguments.length>0&&this.$58l(v,B)},Br=ps.prototype;Br.$58l=function(M,X){this.x=M,this.y=X},Br.add=function(l){return new ps(this.x+l.x,this.y+l.y)},Br.addEquals=function(X){return this.x+=X.x,this.y+=X.y,this},Br.$55l=function(g){return new ps(this.x*g,this.y*g)},Br.eq=function(M){return this.x==M.x&&this.y==M.y},Br.lt=function(Q){return this.x<Q.x&&this.y<Q.y},Br.lte=function(i){return this.x<=i.x&&this.y<=i.y},Br.gt=function(M){return this.x>M.x&&this.y>M.y},Br.gte=function(D){return this.x>=D.x&&this.y>=D.y},Br.lerp=function(I,v){return new ps(this.x+(I.x-this.x)*v,this.y+(I.y-this.y)*v)},Br.distanceFrom=function(M){var h=this.x-M.x,w=this.y-M.y;return o(h*h+w*w)},Br.min=function(B){return new ps(N(this.x,B.x),N(this.y,B.y))},Br.max=function(w){return new ps(X(this.x,w.x),X(this.y,w.y))},Br.toString=function(){return this.x+","+this.y};var bb=function(){this.$58l(arguments)},dd=bb.prototype;bb.TO=1e-6,bb.AC=6,dd.$58l=function(N){this.co=new Array;for(var H=N.length-1;H>=0;H--)this.co.push(N[H])},dd.$55l=function(i){for(var x=new bb,Z=0;Z<=this.$50l()+i.$50l();Z++)x.co.push(0);for(var Z=0;Z<=this.$50l();Z++)for(var p=0;p<=i.$50l();p++)x.co[Z+p]+=this.co[Z]*i.co[p];return x},dd.$59l=function(){for(var Q=this.$50l();Q>=0&&Z(this.co[Q])<=bb.TO;Q--)this.co.pop()},dd.$50l=function(){return this.co.length-1},dd.$51l=function(){var L;switch(this.$59l(),this.$50l()){case 0:L=new Array;break;case 1:L=this.$52l();break;case 2:L=this.$53l();break;case 3:L=this.$54l();break;case 4:L=this.$63l();break;default:L=new Array}return L},dd.$52l=function(){var e=new Array,d=this.co[1];return 0!=d&&e.push(-this.co[0]/d),e},dd.$53l=function(){var P=new Array;if(2==this.$50l()){var M=this.co[2],a=this.co[1]/M,r=this.co[0]/M,Y=a*a-4*r;if(Y>0){var m=o(Y);P.push(.5*(-a+m)),P.push(.5*(-a-m))}else 0==Y&&P.push(.5*-a)}return P},dd.$63l=function(){var B=new Array;if(4==this.$50l()){var j=this.co[4],X=this.co[3]/j,U=this.co[2]/j,P=this.co[1]/j,x=this.co[0]/j,O=new bb(1,-U,X*P-4*x,-X*X*x+4*U*x-P*P).$54l(),n=O[0],A=X*X/4-U+n;if(Z(A)<=bb.TO&&(A=0),A>0){var w=o(A),F=3*X*X/4-w*w-2*U,M=(4*X*U-8*P-X*X*X)/(4*w),h=F+M,G=F-M;if(Z(h)<=bb.TO&&(h=0),Z(G)<=bb.TO&&(G=0),h>=0){var f=o(h);B.push(-X/4+(w+f)/2),B.push(-X/4+(w-f)/2)}if(G>=0){var f=o(G);B.push(-X/4+(f-w)/2),B.push(-X/4-(f+w)/2)}}else if(0>A);else{var M=n*n-4*x;if(M>=-bb.TO){if(0>M&&(M=0),M=2*o(M),F=3*X*X/4-2*U,F+M>=bb.TO){var e=o(F+M);B.push(-X/4+e/2),B.push(-X/4-e/2)}if(F-M>=bb.TO){var e=o(F-M);B.push(-X/4+e/2),B.push(-X/4-e/2)}}}}return B},dd.$54l=function(){var Q=new Array;if(3==this.$50l()){var f=this.co[3],m=this.co[2]/f,U=this.co[1]/f,O=this.co[0]/f,L=(3*U-m*m)/3,_=(2*m*m*m-9*U*m+27*O)/27,F=m/3,T=_*_/4+L*L*L/27,P=_/2;if(Z(T)<=bb.TO&&(T=0),T>0){var z,R,I=o(T);z=-P+I,R=z>=0?Y(z,1/3):-Y(-z,1/3),z=-P-I,z>=0?R+=Y(z,1/3):R-=Y(-z,1/3),Q.push(R-F)}else if(0>T){var e=o(-L/3),J=t(o(-T),-P)/3,N=w(J),S=p(J),n=o(3);Q.push(2*e*N-F),Q.push(-e*(N+n*S)-F),Q.push(-e*(N-n*S)-F)}else{var z;z=P>=0?-Y(P,1/3):Y(-P,1/3),Q.push(2*z-F),Q.push(-z-F)}}return Q};var us=function(R,J){arguments.length>0&&this.$58l(R,J)},cs=us.prototype;cs.$58l=function(g,E){this.x=g,this.y=E},cs.length=function(){return o(this.x*this.x+this.y*this.y)},cs.$60l=function(N){return this.x*N.x+this.y*N.y};var el=function(G,D,J,P){var h,I=(P.x-J.x)*(G.y-J.y)-(P.y-J.y)*(G.x-J.x),k=(D.x-G.x)*(G.y-J.y)-(D.y-G.y)*(G.x-J.x),v=(P.y-J.y)*(D.x-G.x)-(P.x-J.x)*(D.y-G.y);if(0!=v){var r=I/v,F=k/v;r>=0&&1>=r&&F>=0&&1>=F?(h=new ce(e),h.points.push(new ps(G.x+r*(D.x-G.x),G.y+r*(D.y-G.y)))):h=new ce(y)}else h=0==I||0==k?new ce("C"):new ce("P");return h},Aj=function(V,g,F,Q,Z){var i,U,f,O,L,n,A,t=Q.min(Z),T=Q.max(Z),H=new ce(y);i=g.$55l(-2),f=V.add(i.add(F)),i=V.$55l(-2),U=g.$55l(2),O=i.add(U),L=new ps(V.x,V.y),A=new us(Q.y-Z.y,Z.x-Q.x),n=Q.x*Z.y-Z.x*Q.y;for(var x=new bb(A.$60l(f),A.$60l(O),A.$60l(L)+n).$51l(),_=0;_<x.length;_++){var Y=x[_];if(Y>=0&&1>=Y){var r=V.lerp(g,Y),X=g.lerp(F,Y),W=r.lerp(X,Y);Q.x==Z.x?t.y<=W.y&&W.y<=T.y&&(H.$62l=e,H.$56l(W)):Q.y==Z.y?t.x<=W.x&&W.x<=T.x&&(H.$62l=e,H.$56l(W)):W.gte(t)&&W.lte(T)&&(H.$62l=e,H.$56l(W))}}return H},Rl=function(C,t,K,Q,m){var Y=Q.min(m),T=Q.max(m),u=new ps(T.x,Y.y),f=new ps(Y.x,T.y),r=Aj(C,t,K,Y,u),X=Aj(C,t,K,u,T),v=Aj(C,t,K,T,f),J=Aj(C,t,K,f,Y),i=new ce(y);return i.$57l(r.points),i.$57l(X.points),i.$57l(v.points),i.$57l(J.points),i.points.length>0&&(i.$62l=e),i},gq=function(Y,N,Q,v,u,H){var M,s,g,L,C,f,m,k,S,p,K=u.min(H),l=u.max(H),Z=new ce(y);M=Y.$55l(-1),s=N.$55l(3),g=Q.$55l(-3),L=M.add(s.add(g.add(v))),C=new us(L.x,L.y),M=Y.$55l(3),s=N.$55l(-6),g=Q.$55l(3),L=M.add(s.add(g)),f=new us(L.x,L.y),M=Y.$55l(-3),s=N.$55l(3),g=M.add(s),m=new us(g.x,g.y),k=new us(Y.x,Y.y),p=new us(u.y-H.y,H.x-u.x),S=u.x*H.y-H.x*u.y;for(var h=new bb(p.$60l(C),p.$60l(f),p.$60l(m),p.$60l(k)+S).$51l(),t=0;t<h.length;t++){var O=h[t];if(O>=0&&1>=O){var b=Y.lerp(N,O),c=N.lerp(Q,O),j=Q.lerp(v,O),i=b.lerp(c,O),_=c.lerp(j,O),V=i.lerp(_,O);u.x==H.x?K.y<=V.y&&V.y<=l.y&&(Z.$62l=e,Z.$56l(V)):u.y==H.y?K.x<=V.x&&V.x<=l.x&&(Z.$62l=e,Z.$56l(V)):V.gte(K)&&V.lte(l)&&(Z.$62l=e,Z.$56l(V))}}return Z},kj=function(W,x,O,L,f,D){var V=f.min(D),j=f.max(D),s=new ps(j.x,V.y),B=new ps(V.x,j.y),b=gq(W,x,O,L,V,s),r=gq(W,x,O,L,s,j),n=gq(W,x,O,L,j,B),M=gq(W,x,O,L,B,V),c=new ce(y);return c.$57l(b.points),c.$57l(r.points),c.$57l(n.points),c.$57l(M.points),c.points.length>0&&(c.$62l=e),c},uo=function(l,b,O,o){var Y=O.min(o),X=O.max(o),h=new ps(X.x,Y.y),p=new ps(Y.x,X.y),$=el(Y,h,l,b),S=el(h,X,l,b),H=el(X,p,l,b),I=el(p,Y,l,b),T=new ce(y);return T.$57l($.points),T.$57l(S.points),T.$57l(H.points),T.$57l(I.points),T.points.length>0&&(T.$62l=e),T},Pe=i.XEditInteractor=function(F){var a=this,R=a._view=document.createElement("canvas");R.className="editCanvas",R.style.position="absolute",Pe.superClass.constructor.call(a,F)};s.def(Pe,i.Interactor,{ms_edit:1,setUp:function(){var P=this,A=P.gv,D=A.getView(),F=P._view;Pe.superClass.setUp.call(P),A.setEditInteractor(P),A.$14l=F,A._79O?D.insertBefore(F,A._79O):D.appendChild(F);var _=P.$49l=P.$11l.bind(P);A.dm().md(_),A.sm().ms(_),A.mp(_)},tearDown:function(){var Z=this,Q=Z.gv,v=Q.getView(),C=Z.$49l;Pe.superClass.tearDown.call(Z),Q.setEditInteractor(m),Q.$14l=m,v.removeChild(Z._view),Q.dm().umd(C),Q.sm().ums(C),Q.ump(C)},clear:function(){var q=this,x=q.gv;delete q._hoverSegmentIndex,delete q._edge,delete q._shape,delete x._editing,delete q.$10l,delete q.$13l,delete q.$9l,delete q._removePointIndex,delete q._lp,q.$12l="",delete q.$40l,delete q.$67l,delete q.$72l,delete q.$73l,delete q.$75l,delete q.$1l,delete q.$3l,delete q.$2l,delete q.$92l,delete q.$93l,delete q.$94l,q.clearDragging()},handle_keydown:function(S){this.$48l!==S.shiftKey&&(this.$48l=S.shiftKey,this.handle_mousemove(S,v,!0))},handle_keyup:function(G){this.$48l!==G.shiftKey&&(this.$48l=G.shiftKey,this.handle_mousemove(G,v,!0))},handle_touchstart:function(v){this.handle_mousemove(v),this.handle_mousedown(v)},handle_mousedown:function(C){D(C);var z=this,G=z.$13l,E=z.gv,o=E.dm(),w=E.sm(),i=E.getZoom(),e=E.lp(C),A=s.isDoubleClick(C),Y=s.isLeftButton(C),k=z.$7l,B=z._shape,j=z._hoverSegmentIndex,J=z._edge,g=z.$87l,O=z.$88l,q=function(){z._68I||g===z.$87l&&O===z.$88l||z.$43l()};if(7!==z.$67l&&(delete z.$87l,delete z.$88l),Y&&(B||J)&&j>=0&&A&&(B&&w.contains(B)||J&&w.contains(J))){var y=xc.call(z,B||J,j,e);return z.addShapePoint(B||J,j,y),M(function(){z.handle_mousemove(C)},40),void 0}if(Y&&(B||J)&&z._removePointIndex>=0&&A)return z.removeShapePoint(),z.$5l=1,M(function(){z.handle_mousemove(C)},40),void 0;if(!Y||!E._editing)return q(),void 0;if(B&&G>=0){var R=B.getPoints().get(G),L=B.p(),F=Cr(L,R.x-L.x,R.y-L.y,-k+B.getRotation());T=Cr(L,e.x-L.x,e.y-L.y,-k),z.$24l={x:T.x-F.x,y:T.y-F.y},z.startDragging(C),o.beginTransaction(),z.fi({kind:"beginEditPoint",event:C,data:B,index:G}),z.$88l=G,z.$87l=B}else if(z.$10l){var v=E.sm().getSelection(),N=z.$6l,P=z.$1l={},X=z.$3l={},f=z.$16l[I[z.$10l]],W={x:N.x,y:N.y},l={x:N.x+N.width/2,y:N.y+N.height/2};z.$24l={x:e.x-f.x/i,y:e.y-f.y/i},z.$2l=a(z.$8l),z.$4l=a(N),v.each(function(K){if(K instanceof U){var r=K.p(),n=K.getWidth(),F=K.getHeight(),m=Cr(l,r.x-l.x,r.y-l.y,-k);P[K.getId()]={x:r.x-n/2,y:r.y-F/2,width:n,height:F},X[K.getId()]={x:(m.x-W.x)/N.width,y:(m.y-W.y)/N.height}}}),z.startDragging(C),o.beginTransaction(),z.fi({kind:"beginEditRect",event:C,direction:z.$10l})}else if(J&&G>=0){var V=Vp(E.getDataUI(J),J.s("edge.points")),R=V.get(G);z.$24l={x:e.x-R.x,y:e.y-R.y},z.startDragging(C),o.beginTransaction(),z.fi({kind:"beginEditPoint",event:C,data:J,index:G}),z.$88l=G,z.$87l=J}else if(z.$40l){var N=z.$6l,l={x:N.x+N.width/2,y:N.y+N.height/2},Q=a(z.$23l);Q.x/=i,Q.y/=i;var H=Cr(l,Q.x-l.x,Q.y-l.y,-k),T=Cr(l,e.x-l.x,e.y-l.y,-k);z.$24l={x:T.x-H.x,y:T.y-H.y},z.startDragging(C),o.beginTransaction(),z.fi({kind:"beginEditRotation",event:C,data:z._rotationNode})}else if([1,2,3,5,6,7,8,9].indexOf(z.$67l)>=0){var Z=z.$67l;(7===Z||8===Z||9===Z)&&o.beginTransaction(),z.startDragging(C)}else if(z.$71l&&A&&z.$79l(z.$71l,e)){var K=w.toSelection();o.beginTransaction(),K.each(function(_){o.remove(_)}),o.endTransaction()}q()},$11l:function(){var t=this,f=t.gv;f._editing&&(t.$13l==m||t._shape==m&&t._edge==m)&&(t.$73l==m||1!==t.$67l&&5!==t.$67l&&6!==t.$67l)||(t.$5l=1),t._68I=1},$46l:function(G){var v=this,H=v.gv,y=H.lp(G),o=[];return hi(H,function(g){var E=H.getDataUI(g);if(E){var v=E._79o();P(v,y)&&o.push(g)}}),o},$47l:function(S){var x=this,u=x.$13l,D=x.gv.dm();x.$10l?(x.fi({kind:"endEditRect",event:S,direction:x.$10l}),D.endTransaction()):x._shape&&u>=0?(x.fi({kind:"endEditPoint",event:S,data:x._shape,index:u}),D.endTransaction()):x._edge&&u>=0?(x.fi({kind:"endEditPoint",event:S,data:x._edge,index:u}),D.endTransaction()):x.$23l&&x.$40l&&(x.fi({kind:"endEditRotation",event:S}),D.endTransaction())},handleWindowTouchEnd:function(w){this.handleWindowMouseUp(w)},handleWindowMouseUp:function(K){var y=this,O=y.gv,G=O.dm(),z=y._shape,B=y._edge,a=y.$13l,h=y.$40l,Y=y.$9l,x=y.$10l,W=y.$67l;if((z||B)&&a>=0&&Y>=0){var L,N;if(z){var r=z.p(),i=z.getRotation();L=z.getPoints(),N=L.get(Y),hh(z,r,i,a,N,!1)}else if(L=Vp(O.getDataUI(B),B.s("edge.points"),!0),N=L.get(Y),0===a){var A=L.get(0);B.s("edge.source.offset.x",N.x-A.x),B.s("edge.source.offset.y",N.y-A.y)}else if(a===L.size()-1){var Z=L.get(L.size()-1);B.s("edge.target.offset.x",N.x-Z.x),B.s("edge.target.offset.y",N.y-Z.y)}else"points"===B.s("edge.type")&&(L.set(a,N),B.s("edge.points",Ff(L)))}y.$47l(K);var X=y.$73l;1===W?(G.beginTransaction(),X?O.sm().each(function(U){if(U.setHost&&O.isHelperEditable(U,"host")){U.setHost(X);
var r=y.$75l,g=y.$74l;r&&(U.s("attach.row.index",r.rowIndex),U.s("attach.column.index",r.columnIndex)),g&&(U.s("attach.index",g.attachIndex),U.s("attach.offset",g.attachOffset),U.s("attach.offset.relative",!1),U.s("attach.offset.opposite",!1))}}):O.sm().each(function(u){u.setHost&&O.isHelperEditable(u,"host")&&(u.setHost(m),u.s("attach.row.index",v),u.s("attach.column.index",v),u.s("attach.index",v),u.s("attach.offset",v),u.s("attach.offset.relative",!1),u.s("attach.offset.opposite",!1))}),G.endTransaction()):2===W?(G.beginTransaction(),X?O.sm().each(function(d){d.setParent&&O.isHelperEditable(d,"parent")&&d.setParent(X)}):O.sm().each(function(k){k.setParent&&O.isHelperEditable(k,"parent")&&k.setParent(m)}),G.endTransaction()):3===W?X&&(G.beginTransaction(),O.sm().each(function(P){if(O.isHelperEditable(P,"edge")&&P instanceof U&&X instanceof U){var C=new Q.Edge;G.add(C),C.setSource(P),C.setTarget(X),y.onEdgeCreated&&y.onEdgeCreated(K,C)}}),G.endTransaction()):5===W||6===W?X&&(G.beginTransaction(),O.sm().each(function(L){L instanceof $&&X instanceof U&&(5===W&&O.isHelperEditable(L,"source")?L.setSource(X):6===W&&O.isHelperEditable(L,"source")&&L.setTarget(X))}),G.endTransaction()):(7===W||8===W||9===W)&&G.endTransaction(),(x||h)&&y.$43l(!0),f?(y.clear(),delete y.$64l,y._68I||y.$43l()):(y.handle_mousemove(K,!0),W&&!y._68I&&y.$43l())},handleWindowTouchMove:function(Z){this.handleWindowMouseMove(Z)},handleWindowMouseMove:function(Z){this._78I(Z)},handle_mousemove:function(U,k,Q){if(!this._pause){if(!Q){var T=f?wj(U):U;this.$61l={clientX:T.clientX,clientY:T.clientY}}if(k===!0||!L()){var A=this,z=A.gv,l=!1,H=m;A.clear(),z.sm().size()>0&&(H=z.lp(Q?A.$61l:U),l=A._79I(U,H)),l&&(z._editing=1),A.$12l!==A.$65l&&(A.$65l=A.$12l,A.setCursor(A.$12l)),A.$40l!==A.$64l&&(A.$64l=A.$40l,A._68I||A.$43l()),A._hoverSegmentIndex!==A.$66l&&(A.$66l=A._hoverSegmentIndex,A._68I||A.$43l())}}},_78I:function(A){this.autoScroll(A);var w=this,r=w.gv,G=r.lp(A),q=r.getZoom(),p=w.$13l;if((w._shape||w._edge)&&p>=0){var k,c,i,H=w._shape,j=w._edge,T=w.$24l,N=r.getPointSnapSpacing(),u=function(s,O){return N==m||isNaN(N)?{x:s,y:O}:{x:x(s/N)*N,y:x(O/N)*N}};if(H){k=H.getPoints();var K=H.p(),d=H.getRotation(),f=0;c=Cr(K,G.x-K.x,G.y-K.y,-d),hh(H,K,d,p,G,!0,T,u),w.fi({kind:"betweenEditPoint",event:A,data:H,index:p})}else if(j){k=Vp(r.getDataUI(j),j.s("edge.points"),!0),G.x-=T.x,G.y-=T.y,c=G;var D,O,P=j.s("edge.offset"),a=k.size(),E=a>2;if(0===p){var V=k.get(0);P&&(V=Oj(V,k.get(1),-P,E),G=Oj(G,k.get(1),-P,E)),D=G.x-V.x,O=G.y-V.y,i=u(D,O),j.s("edge.source.offset.x",i.x),j.s("edge.source.offset.y",i.y)}else if(p===a-1){var v=k.get(a-1);P&&(v=Oj(v,k.get(a-2),-P,E),G=Oj(G,k.get(a-2),-P,E)),D=G.x-v.x,O=G.y-v.y,i=u(D,O),j.s("edge.target.offset.x",i.x),j.s("edge.target.offset.y",i.y)}else"points"===j.s("edge.type")&&(i=u(G.x,G.y),i.e=k.get(p).e,k.set(p,i),j.s("edge.points",Ff(k)));w.fi({kind:"betweenEditPoint",event:A,data:j,index:p})}if(delete w.$9l,r.isSnapPoint(H)||r.isSnapPoint(j))for(f=0;f<k.size();f++)if(f!==p){var y=k.get(f);if(R(y,c)<r.getEditPointSize()/q){w.$9l=f;break}}}else if(w.$10l){var T=w.$24l;G.x-=T.x,G.y-=T.y;var B=r.sm().getSelection(),S=w.$1l,I=w.$7l,F=w.$10l,L=w.$4l,X=w.$2l,g=r.getEditRectPadding()/q,_=2*g,h=r.getSnapSpacing(),n=h!=m&&!isNaN(h),Q=rc(X,G,F,I,2*g,r.getResizeMode(),n,!0),z=w.$6l;if(n){var e=Q.width-_,b=Q.height-_,Y=x(e/h)*h,or=x(b/h)*h,ps=Y-e,mp=or-b;("west"===F||"northwest"===F||"southwest"===F)&&(ps=-ps),("north"===F||"northwest"===F||"northeast"===F)&&(mp=-mp),Q=rc(X,G,F,I,2*g,r.getResizeMode(),n,!1,ps,mp)}w.$8l=Q,z.x=Q.x+g,z.y=Q.y+g,z.width=Q.width-_,z.height=Q.height-_;var el=Q.x+Q.width/2,Ml=Q.y+Q.height/2,Al=z.x,Em=z.y,cs=z.width/L.width,qm=z.height/L.height;B.each(function(e){if(e instanceof U&&r.isEditable(e)&&r.isRectEditable(e)){var L=S[e.getId()],$=w.$3l[e.getId()],i={x:L.x+L.width/2,y:L.y+L.height/2},f=0,p=0,h=F,d=180*Z(I-e.getRotation())/C;"northeast"===F?d>=315||45>d?(f=L.width*cs+L.x,p=L.height*(1-qm)+L.y,h="northeast"):d>=45&&135>d?(f=L.width*(1-qm)+L.x,p=L.height*(1-cs)+L.y,h="northwest"):d>=135&&225>d?(f=L.width*(1-cs)+L.x,p=L.height*qm+L.y,h="southwest"):(f=L.width*qm+L.x,p=L.height*cs+L.y,h="southeast"):"north"===F?d>=315||45>d?(p=L.height*(1-qm)+L.y,h="north"):d>=45&&135>d?(f=L.width*(1-qm)+L.x,h="west"):d>=135&&225>d?(p=L.height*qm+L.y,h="south"):(f=L.width*qm+L.x,h="east"):"northwest"===F?d>=315||45>d?(f=L.width*(1-cs)+L.x,p=L.height*(1-qm)+L.y,h="northwest"):d>=45&&135>d?(f=L.width*(1-qm)+L.x,p=L.height*cs+L.y,h="southwest"):d>=135&&225>d?(f=L.width*cs+L.x,p=L.height*qm+L.y,h="southeast"):(f=L.width*qm+L.x,p=L.height*(1-cs)+L.y,h="northeast"):"west"===F?d>=315||45>d?(f=L.width*(1-cs)+L.x,h="west"):d>=45&&135>d?(p=L.height*cs+L.y,h="south"):d>=135&&225>d?(f=L.width*cs+L.x,h="east"):(p=L.height*(1-cs)+L.y,h="north"):"southwest"===F?d>=315||45>d?(f=L.width*(1-cs)+L.x,p=L.height*qm+L.y,h="southwest"):d>=45&&135>d?(f=L.width*qm+L.x,p=L.height*cs+L.y,h="southeast"):d>=135&&225>d?(f=L.width*cs+L.x,p=L.height*(1-qm)+L.y,h="northeast"):(f=L.width*(1-qm)+L.x,p=L.height*(1-cs)+L.y,h="northwest"):"east"===F?d>=315||45>d?(f=L.width*cs+L.x,h="east"):d>=45&&135>d?(p=L.height*(1-cs)+L.y,h="north"):d>=135&&225>d?(f=L.width*(1-cs)+L.x,h="west"):(p=L.height*cs+L.y,h="south"):"south"===F?d>=315||45>d?(p=L.height*qm+L.y,h="south"):d>=45&&135>d?(f=L.width*qm+L.x,h="east"):d>=135&&225>d?(p=L.height*(1-qm)+L.y,h="north"):(f=L.width*(1-qm)+L.x,h="west"):"southeast"===F&&(d>=315||45>d?(f=L.width*cs+L.x,p=L.height*qm+L.y,h="southeast"):d>=45&&135>d?(f=L.width*qm+L.x,p=L.height*(1-cs)+L.y,h="northeast"):d>=135&&225>d?(f=L.width*(1-cs)+L.x,p=L.height*(1-qm)+L.y,h="northwest"):(f=L.width*(1-qm)+L.x,p=L.height*cs+L.y,h="southwest"));var Q=Cr(i,f-i.x,p-i.y,e.getRotation());Hq(e,L,h,{x:Q.x,y:Q.y});var b=Al+z.width*$.x,H=Em+z.height*$.y,l={x:b,y:H};l=Cr({x:el,y:Ml},l.x-el,l.y-Ml,I),e.p(l.x,l.y)}}),w.fi({kind:"betweenEditRect",event:A,direction:F})}else if(w.$23l&&w.$40l){var ed=w.$8l,Gb=ed.width,gd=ed.height,K={x:ed.x+Gb/2,y:ed.y+gd/2},T=w.$24l,cl=w.$23l,Xj=cl.x/q-K.x,ze=cl.y/q-K.y,Wk=o(Xj*Xj+ze*ze),Xn=Math.asin(T.x/Wk),Ui=r.sm().getSelection(),vc=l+t(G.y-K.y,G.x-K.x)-Xn,Hk=r.getSnapAngle(),vc=x(vc/Hk)*Hk;0>vc&&(vc+=J);var sc=vc-w.$7l,Tk=[K.x,0,K.y];Ui.each(function(b){if(r.isEditable(b)&&r.isRotationEditable(b)&&r.isVisible(b)){var Y=ki(b.p3(),Tk),X=Qh();mq(X,-sc),b.setRotation(b.getRotation()+sc),cg(Y,X),b.p3(Tk[0]+Y[0],Tk[1]+Y[1],Tk[2]+Y[2])}}),w.$7l=vc,w.fi({kind:"betweenEditRotation",event:A})}else if([1,2,3,5,6].indexOf(w.$67l)>=0)w.$72l=A,w.$78l||(w.$78l=1,M(function(){s.isDragging()&&w.$43l(),delete w.$78l},12));else if(7===w.$67l){if(w.$87l instanceof W){var H=w.$87l,Mc=w.$88l,Qb=s.clone(H.getPoints().get(Mc)),Ri=G.y-Qb.y;Qb.e||(Qb.e=0),w.$92l||(w.$92l=Qb.e),Qb.e=w.$92l-Ri,H.setPoint(Mc,Qb)}else if(w.$87l instanceof $){var j=w.$87l,Mc=w.$88l,k=Vp(r.getDataUI(j),j.s("edge.points")),Qb=k.get(Mc),Ri=G.y-Qb.y;Qb.e||(Qb.e=0),w.$92l||(w.$92l=Qb.e),Qb.e=w.$92l-Ri,k.set(Mc,Qb),j.s("edge.points",Ff(k))}}else if(8===w.$67l){var Ui=r.sm().getSelection(),Ch=w.$93l;Ch||(Ch=w.$93l={}),Ui.each(function(Y){if(Y.p3){var v=Y.p3(),K=Ch[Y.getId()];K==m&&(K=Ch[Y.getId()]=v[1]),Y.p3([v[0],K-(G.y-w.$90l.y/q),v[2]])}})}else if(9===w.$67l){var Ui=r.sm().getSelection(),qc=w.$94l;qc||(qc=w.$94l={}),Ui.each(function(L){if(L.s3){var d=L.s3(),r=qc[L.getId()];r==m&&(r=qc[L.getId()]=d[1]);var Y=r-(G.y-w.$91l.y/q);0>Y&&(Y=.01),L.s3([d[0],Y,d[2]])}})}},$79l:function(I,k){var m=this,H=m.gv,f=H.getZoom(),e=H.getEditHelperSize(),M=I.x/f,l=I.y/f,$=e/f,o=$/2;return P({x:M-o,y:l-o,width:$,height:$},k)?!0:void 0},getHelperCursor:function(){return"crosshair"},_79I:function(E,D){for(var b=this,u=b.gv,d=u.getZoom(),k=u.getEditPointSize(),r=k/d,j=r/2,T=b.$46l(E),U=0;U<T.length;U++){var Z,A,w=T[U],N=u.getDataUI(w);if(N&&N._55O){var h=N._55O;if(h._43O&&w instanceof $){if(Z=w.s("edge.points"),Z=Vp(N,Z),A=w.s("edge.segments"),A&&A.size()||(A=kd(Z)),b.$42l(w,D,Z._as,A,"edge"))return!0;if("points"===w.s("edge.type"))return b.$41l(w,D,Z._as,A,"edge"),void 0}if(h._43O&&w instanceof W&&h.$15l&&h.$15l.length===w.getPoints().size()){if(Z=h.$15l,A=w.getSegments(),A&&A.size()||(A=kd(Z)),b.$42l(w,D,Z,A,"shape"))return!0;if(b.$41l(w,D,Z,A,"shape"))return}}}if(b.$16l){var Z,X=b.$16l,L=X[3].x-X[7].x,f=X[3].y-X[7].y,J=o(L*L+f*f),m=X[1].x-X[5].x,S=X[1].y-X[5].y,l=o(m*m+S*S),B={x:D.x*d,y:D.y*d};if(b._80I(B,0,X[0],"northwest",J,l)||b._80I(B,1,X[1],"north",J,l)||b._80I(B,2,X[2],"northeast",J,l)||b._80I(B,7,X[7],"west",J,l)||b._80I(B,3,X[3],"east",J,l)||b._80I(B,6,X[6],"southwest",J,l)||b._80I(B,5,X[5],"south",J,l)||b._80I(B,4,X[4],"southeast",J,l))return!0}if(b.$23l){var c=b.$23l,C=c.x/d,Y=c.y/d;if(P({x:C-j,y:Y-j,width:r,height:r},D))return b.$40l=1,b.$12l=b.getHelperCursor("rotation")||"crosshair",!0}return b.$68l&&b.$79l(b.$68l,D)?(b.$67l=1,b.$12l=b.getHelperCursor("host")||"crosshair",!0):b.$69l&&b.$79l(b.$69l,D)?(b.$67l=2,b.$12l=b.getHelperCursor("parent")||"crosshair",!0):b.$70l&&b.$79l(b.$70l,D)?(b.$67l=3,b.$12l=b.getHelperCursor("edge")||"crosshair",!0):b.$71l&&b.$79l(b.$71l,D)?(b.$67l=4,b.$12l=b.getHelperCursor("remove")||"crosshair",!0):b.$82l&&b.$79l(b.$82l,D)?(b.$67l=5,b.$12l=b.getHelperCursor("source")||"crosshair",!0):b.$83l&&b.$79l(b.$83l,D)?(b.$67l=6,b.$12l=b.getHelperCursor("target")||"crosshair",!0):b._pointElevationHelperPoint&&b.$79l(b._pointElevationHelperPoint,D)?(b.$67l=7,b.$12l=b.getHelperCursor("pointElevation")||"crosshair",!0):b.$90l&&b.$79l(b.$90l,D)?(b.$67l=8,b.$12l=b.getHelperCursor("elevation")||"crosshair",!0):b.$91l&&b.$79l(b.$91l,D)?(b.$67l=9,b.$12l=b.getHelperCursor("tall")||"crosshair",!0):!1},_80I:function(b,k,A,e,L,c){var m=this,v=m.gv,V=v.getEditPointSize(),f=V/2,B=v.sm(),s=v.isDirectionEditable;if(s&&1===B.size()){var w=B.ld();if(s=s.bind(v),w instanceof U){if(!s(w,e))return!1;if("east"===e){if(s(w,"northeast")&&s(w,"southeast")&&2*V>=c)return!1}else if("west"===e){if(s(w,"northwest")&&s(w,"southwest")&&2*V>=c)return!1}else if("north"===e){if(s(w,"northwest")&&s(w,"northeast")&&2*V>=L)return!1}else if("south"===e&&s(w,"southwest")&&s(w,"southeast")&&2*V>=L)return!1}}else{if(2*V>=L&&("north"===e||"south"===e))return!1;if(2*V>=c&&("east"===e||"west"===e))return!1}if(P({x:A.x-f,y:A.y-f,width:V,height:V},b)){if(m.$10l!==e){var T=180*m.$7l/C,O="";T>=337.5||22.5>T?O="north":T>=22.5&&67.5>T?O="northeast":T>=67.5&&112.5>T?O="east":T>=112.5&&157.5>T?O="southeast":T>=157.5&&202.5>T?O="south":T>=202.5&&247.5>T?O="southwest":T>=247.5&&292.5>T?O="west":T>=292.5&&337.5>T&&(O="northwest");var o=Go.indexOf(O),O=Go[k-(1-o)+8];switch(O){case"northwest":m.$12l="nwse-resize";break;case"northeast":m.$12l="nesw-resize";break;case"southwest":m.$12l="nesw-resize";break;case"southeast":m.$12l="nwse-resize";break;case"north":m.$12l="ns-resize";break;case"east":m.$12l="ew-resize";break;case"south":m.$12l="ns-resize";break;case"west":m.$12l="ew-resize"}m.$10l=e}return!0}return!1},$42l:function(s,d,l,v,R){var C,E=this,b=E.gv,z=b.getEditPointSize(),x=z/b.getZoom(),w=-1,Y={x:d.x,y:d.y,width:0,height:0},G=function(o){"shape"===R?E._shape=s:E._edge=s,E._removePointIndex=o},X=function(i){"shape"===R?E._shape=s:E._edge=s,E.$13l=i,E.$12l="crosshair"};for(g(Y,x/2),w=l.length-1,C=v.size()-1;C>=0;C--){var S=v.get(C);if(1===S||2===S)w-=1;else if(3===S){var y=l[w-1];if(P(Y,y))return X(w-1),!0;w-=2}else if(4===S){var j=l[w-1],_=l[w-2];if(P(Y,j))return X(w-1),!0;if(P(Y,_))return X(w-2),!0;w-=3}}for(w=l.length-1,C=v.size()-1;C>=0;C--){var S=v.get(C),i=l[w];if(P(Y,i))return G(w),X(w),!0;1===S||2===S?w-=1:3===S?w-=2:4===S&&(w-=3)}return!1},$41l:function(i,G,X,L,Y){var E=this,k=E.gv,K=-1,V=0,F={x:G.x,y:G.y,width:0,height:0},$=function(u,z){E._hoverSegmentIndex=z,E._lp=G,"shape"===Y?E._shape=i:E._edge=i};for(g(F,k.getSegmentHoverWidth()/2/k.getZoom()),i instanceof W&&i.isClosePath()&&L.indexOf(5)<0&&(L=new z(L._as),L.add(5));V<L.size();V++){var c=L.get(V);if(1===c){var T=X[K],n=X[K+1];if(T){var u=uo(new ps(T.x,T.y),new ps(n.x,n.y),new ps(F.x,F.y),new ps(F.x+F.width,F.y+F.height));if(u.$62l===e&&u.points.length>0)return $(u,V),!0}K+=1}else if(2===c){var T=X[K],n=X[K+1],u=uo(new ps(T.x,T.y),new ps(n.x,n.y),new ps(F.x,F.y),new ps(F.x+F.width,F.y+F.height));if(u.$62l===e&&u.points.length>0)return $(u,V),!0;K+=1}else if(3===c){var T=X[K],x=X[K+1],o=X[K+2],u=Rl(new ps(T.x,T.y),new ps(x.x,x.y),new ps(o.x,o.y),new ps(F.x,F.y),new ps(F.x+F.width,F.y+F.height));if(u.$62l===e)return $(u,V),!0;K+=2}else if(4===c){var T=X[K],p=X[K+1],w=X[K+2],o=X[K+3],u=kj(new ps(T.x,T.y),new ps(p.x,p.y),new ps(w.x,w.y),new ps(o.x,o.y),new ps(F.x,F.y),new ps(F.x+F.width,F.y+F.height));if(u.$62l===e)return $(u,V),!0;K+=3}else if(5===c){var T=X[K],n=X[0];if(T){var u=uo(new ps(T.x,T.y),new ps(n.x,n.y),new ps(F.x,F.y),new ps(F.x+F.width,F.y+F.height));if(u.$62l===e&&u.points.length>0)return $(u,V),!0}}}return!1},addShapePoint:function(T,O,Y){var X=this,R=X.gv,U=R.dm();if(U.beginTransaction(),0===arguments.length&&(T=X._shape||X._edge,O=X._hoverSegmentIndex,Y=X._lp),T instanceof W||T instanceof $){var C=Yb(T,R.getDataUI(T),O);if(!isNaN(O)&&Y&&!isNaN(C)){var M=Y;if(T instanceof W){var H=T.p(),h=T.getRotation(),_=T.toSegments();_&&_.size()||(_=kd(T.getPoints())),T.isClosePath()&&_.indexOf(5)<0&&(_=new z(_._as),_.add(5));var c=_.get(O),b="addPoint",r="removePointAt";if(2===c||1===c){var s={x:M.x,y:M.y};_.add(c,O),s=Cr(H,s.x-H.x,s.y-H.y,-h),T[b](s,C+1)}else if(3===c){var G=T.getPoints(),Z=G.get(C),j=G.get(C+2),s={x:M.x,y:M.y};s=Cr(H,s.x-H.x,s.y-H.y,-h);var g=li(Z,s),l=li(s,j);_.removeAt(O),_.add(3,O),_.add(3,O),T.setPoint(C+1,s),T[b](l,C+2),T[b](g,C+1)}else if(4===c){var G=T.getPoints(),Z=G.get(C),j=G.get(C+3),s={x:M.x,y:M.y};s=Cr(H,s.x-H.x,s.y-H.y,-h);var g=ho(Z,s),l=Xb(Z,s),f=ho(s,j),o=Xb(s,j);_.removeAt(O),_.add(4,O),_.add(4,O),T[r](C+1),T[r](C+1),T[b](s,C+1),T[b](o,C+2),T[b](f,C+2),T[b](l,C+1),T[b](g,C+1)}else if(5===c){var s={x:M.x,y:M.y};_.add(2,O),s=Cr(H,s.x-H.x,s.y-H.y,-h),T[b](s,C+1)}T.isClosePath()&&_.remove(5),T.setSegments(_);var J=T.getWidth(),K=T.getHeight(),V=T.p().x-J/2,v=T.p().y-K/2;V-=H.x,v-=H.y;var e=kl(T,{x:V,y:v,width:J,height:K},h,H);T.p(e.x,e.y)}else if(T instanceof $){if("points"!==T.s("edge.type"))return U.endTransaction(),void 0;var G=T.s("edge.points");_=T.s("edge.segments"),G=Vp(R.getDataUI(T),G),_&&_.size()||(_=kd(G)),_=new z(_._as.slice(0)),G=new z(G._as.slice(0));var c=_.get(O);if(2===c||1===c){var s={x:M.x,y:M.y};_.add(c,O),G.add(s,C+1)}else if(3===c){var Z=G.get(C),j=G.get(C+2),s={x:M.x,y:M.y},g=li(Z,s),l=li(s,j);_.removeAt(O),_.add(3,O),_.add(3,O),G.set(C+1,s),G.add(l,C+2),G.add(g,C+1)}else if(4===c){var Z=G.get(C),j=G.get(C+3),s={x:M.x,y:M.y},g=ho(Z,s),l=Xb(Z,s),f=ho(s,j),o=Xb(s,j);_.removeAt(O),_.add(4,O),_.add(4,O),G.removeAt(C+1),G.removeAt(C+1),G.add(s,C+1),G.add(o,C+2),G.add(f,C+2),G.add(l,C+1),G.add(g,C+1)}T.s("edge.points",Ff(G)),T.s("edge.segments",_)}}}U.endTransaction()},removeShapePoint:function(v,q){var c=this,Z="removeAt",o=c.gv,U=o.dm();if(U.beginTransaction(),0===arguments.length&&(v=c._shape||c._edge,q=c._removePointIndex),q>=0&&(v instanceof W||v instanceof $)){var i=Xm(v,c.gv.getDataUI(v),q),m=q;if(v instanceof W){var K=v.p(),T=v.toSegments();T&&T.size()||(T=kd(v.getPoints()));var E=T.get(i),n="removePointAt";if(1===E&&0===m)if(v.getPoints().size()>1){var P=T.get(i+1);T[Z](i+1),3===P?v[n](m+1):4===P&&(v[n](m+2),v[n](m+1)),v[n](m)}else v.dm().remove(v);else 2===E||1===E?(T[Z](i),v[n](m)):3===E?(T[Z](i),v[n](m),v[n](m-1)):4===E&&(T[Z](i),v[n](m),v[n](m-1),v[n](m-2));v.setSegments(T);var w=v.getWidth(),t=v.getHeight(),j=v.p().x-w/2,H=v.p().y-t/2;j-=K.x,H-=K.y;var s=kl(v,{x:j,y:H,width:w,height:t},v.getRotation(),K);v.p(s.x,s.y)}else if(v instanceof $){if("points"!==v.s("edge.type"))return U.endTransaction(),void 0;var b=v.s("edge.points");if(T=v.s("edge.segments"),b&&(b=Vp(c.gv.getDataUI(v),b),T&&T.size()||(T=kd(b))),0===q||q===b.size()-1)return U.endTransaction(),void 0;T=new z(T._as.slice(0)),b=new z(b._as.slice(0));var E=T.get(i);2===E||1===E?(T[Z](i),b[Z](m)):3===E?(T[Z](i),b[Z](m),b[Z](m-1)):4===E&&(T[Z](i),b[Z](m),b[Z](m-1),b[Z](m-2)),v.s("edge.segments",T),v.s("edge.points",Ff(b))}}U.endTransaction()},changeShapeSegment:function(r,D,x){var l=this,s=l.gv,U=s.dm();if(U.beginTransaction(),1!==arguments.length||isNaN(r)||(x=r,r=l._shape||l._edge,D=l._hoverSegmentIndex),r instanceof W||r instanceof $){var C=Yb(r,l.gv.getDataUI(r),D);if(!isNaN(D)&&!isNaN(C))if(r instanceof W){var O=r.p(),T=r.toSegments();T&&T.size()||(T=kd(r.getPoints()));var K=T.get(D),p=r.toPoints();if(1===x||2===x)1===K||2===K?T.set(D,x):3===K?(T.set(D,x),p.removeAt(C+1)):4===K&&(T.set(D,x),p.removeAt(C+1),p.removeAt(C+1));else if(3===x){var Q=function(){var b=p.get(C),M=p.get(C+1),V=li(b,M);T.set(D,3),p.add(V,C+1)};2===K||1===K?Q():4===K&&(p.removeAt(C+1),p.removeAt(C+1),Q())}else if(4===x){var f=function(){var K=p.get(C),B=p.get(C+1),W=ho(K,B),q=Xb(K,B);T.set(D,4),p.add(W,C+1),p.add(q,C+2)};2===K||1===K?f():3===K&&(p.removeAt(C+1),f())}r.setSegments(T),r.setPoints(p);var j=r.getWidth(),w=r.getHeight(),Z=r.p().x-j/2,P=r.p().y-w/2;Z-=O.x,P-=O.y;var d=new kl(r,{x:Z,y:P,width:j,height:w},r.getRotation(),O);r.p(d.x,d.y)}else if(r instanceof $){if("points"!==r.s("edge.type"))return U.endTransaction(),void 0;var p=r.s("edge.points");T=r.s("edge.segments"),p&&(p=Vp(l.gv.getDataUI(r),p),T&&T.size()||(T=kd(p))),T=new z(T._as.slice(0)),p=new z(p._as.slice(0));var K=T.get(D);if(1===x||2===x)1===K||2===K?T.set(D,x):3===K?(T.set(D,x),p.removeAt(C+1)):4===K&&(T.set(D,x),p.removeAt(C+1),p.removeAt(C+1));else if(3===x){var Q=function(){var c=p.get(C),I=p.get(C+1),H=li(c,I);T.set(D,3),p.add(H,C+1)};2===K||1===K?Q():4===K&&(p.removeAt(C+1),p.removeAt(C+1),Q())}else if(4===x){var f=function(){var H=p.get(C),t=p.get(C+1),b=ho(H,t),Y=Xb(H,t);T.set(D,4),p.add(b,C+1),p.add(Y,C+2)};2===K||1===K?f():3===K&&(p.removeAt(C+1),f())}r.s("edge.points",Ff(p)),r.s("edge.segments",T)}}U.endTransaction()},getDefaultSegments:function(r){var s=this.gv,i=s.getDataUI(r);if(r instanceof $){var V=r.s("edge.points");return V=Vp(i,V),kd(V)}if(r instanceof W){var V=r.getPoints(),h=r.getSegments();return h&&h.size()>0?h:kd(V)}},$43l:function(j){var p=this;j&&(p.$5l=1),p._68I=1,p._42()},_42:function(){var x=this;if(x._68I){delete x._68I;var A=x.gv,v=x.$5l,y=A.getZoom(),L=A.getEditPointSize(),Z=L/2,O=new z,N=x._view,I=x._edge,G=x._shape,V=N.getContext("2d"),n=A.tx(),w=A.ty(),F=m,t=A.getEditPointBackground(),B=A.getControlPointBackground(),d=A.getControlPointBorderColor(),H=A.getEditPointBorderColor(),r=A.getEditRectBorderColor(),C=A.getDirectionLineColor(),D=A.getSegmentHoverColor(),f=A.getSnapPointBorderColor(),P=A.getJoinPointBackground(),p=A.getJoinPointBorderColor(),e=A.getSegmentHoverWidth(),l=[5,5],M=A.getEditRectBorderStyle();ar(A,function(u){A.isSelected(u)&&A.isVisible(u)&&O.add(u)}),V.clearRect(0,0,k(N.width),k(N.height)),V.save(),T.translateAndScale(V,n,w,1);var b=m,X={x:0,y:0,width:0,height:0},Y=0,i=0,S=0,R=0,_=0,j=0,kq=0,wm=0,Mh=0,ym=0,np=[];if(v?(delete x.$6l,delete x.$8l,delete x.$7l,delete x.$16l,delete x.$23l):(b=x.$6l,F=x.$7l),delete x.$68l,delete x.$69l,delete x.$71l,delete x.$70l,delete x.$82l,delete x.$83l,delete x._pointElevationHelperPoint,delete x.$90l,delete x.$91l,delete x.$75l,delete x.$74l,O.each(function(C){var v=A.getDataUI(C);if(v){var n=v._55O;if(A.isEditable(C))n._56O&&C instanceof U&&i++,np.push(C),n._42O&&C instanceof U&&Y++,A.isHelperEditable(C,"host")&&R++,A.isHelperEditable(C,"parent")&&S++,A.isHelperEditable(C,"remove")&&_++,A.isHelperEditable(C,"edge")&&j++,A.isHelperEditable(C,"source")&&kq++,A.isHelperEditable(C,"target")&&wm++,A.isHelperEditable(C,"elevation")&&Mh++,A.isHelperEditable(C,"tall")&&ym++;else if(C instanceof K&&C.isExpanded()){var q=!0,f=A.getEditableFunc();f&&(q=f(C)),q&&(A.isHelperEditable(C,"host")&&R++,A.isHelperEditable(C,"parent")&&S++,A.isHelperEditable(C,"remove")&&_++,A.isHelperEditable(C,"edge")&&j++,A.isHelperEditable(C,"source")&&kq++,A.isHelperEditable(C,"target")&&wm++,A.isHelperEditable(C,"elevation")&&Mh++,A.isHelperEditable(C,"tall")&&ym++,np.push(C))}}}),V.beginPath(),V.lineWidth=1,V.strokeStyle=A.getNodeBorderColor(),np.forEach(function(M){var t=A.getDataUI(M),Q=t._55O;if(v)if(F==m&&(F=M instanceof $?0:M instanceof K&&M.isExpanded()?0:M.getRotation(),x.$7l=F),b==m){var S,R,u;if(M instanceof K&&M.isExpanded()||M instanceof $){var O=A.getDataUIBounds(M);R=O.width,u=O.height,S={x:O.x+R/2,y:O.y+u/2}}else S=M.p(),R=M.getWidth(),u=M.getHeight();b={x:S.x,y:S.y,width:0,height:0},X.x=S.x-R/2,X.y=S.y-u/2,X.width=R,X.height=u,b=h(b,X)}else{var S,R,u,n,s=b.x+b.width/2,C=b.y+b.height/2,e={x:s,y:C};if(M instanceof K&&M.isExpanded()||M instanceof $){n=0;var O=A.getDataUIBounds(M);R=O.width,u=O.height,S={x:O.x+R/2,y:O.y+u/2}}else S=M.p(),R=M.getWidth(),u=M.getHeight(),n=M.getRotation();var Z={x:S.x-R/2,y:S.y-u/2,width:R,height:u},_={x:Z.x,y:Z.y},p={x:Z.x+Z.width,y:Z.y},l={x:Z.x,y:Z.y+Z.height},c={x:Z.x+Z.width,y:Z.y+Z.height},_=Cr(S,_.x-S.x,_.y-S.y,n),l=Cr(S,l.x-S.x,l.y-S.y,n),c=Cr(S,c.x-S.x,c.y-S.y,n),p=Cr(S,p.x-S.x,p.y-S.y,n),I=-F,H=Cr(e,_.x-e.x,_.y-e.y,I),r=Cr(e,p.x-e.x,p.y-e.y,I),q=Cr(e,l.x-e.x,l.y-e.y,I),P=Cr(e,c.x-e.x,c.y-e.y,I),o=E([H,r,q,P]);b=h(b,o),b.x-=s,b.y-=C;var g=kl(m,b,F,e);b.x=g.x-b.width/2,b.y=g.y-b.height/2}if(Y>1&&A.isEditable(M)&&A.isRectEditable(M)&&M instanceof U){var w=M.getRect(),B=Q.$45l,L=Yd(B[0],y),T=Yd(B[2],y),d=Yd(B[4],y),z=Yd(B[6],y);M.getRotation()?(V.moveTo(L.x,L.y),V.lineTo(T.x,T.y),V.lineTo(d.x,d.y),V.lineTo(z.x,z.y),V.lineTo(L.x,L.y)):V.rect(w.x*y,w.y*y,w.width*y,w.height*y)}}),V.stroke(),b){x.$6l=a(b),g(b,A.getEditRectPadding()/y);var Wd={x:b.x+b.width/2,y:b.y+b.height/2},is=tl(Wd,b.width,b.height,F),Ge=is[0],os=is[1],fb=is[2],Wi=is[3],Mq=is[4],Ql=is[5],_m=is[6],sf=is[7];if(Ge=Yd(is[0],y),os=Yd(is[1],y),fb=Yd(is[2],y),Wi=Yd(is[3],y),Mq=Yd(is[4],y),Ql=Yd(is[5],y),_m=Yd(is[6],y),sf=Yd(is[7],y),x.$8l=b,Y>0&&(x.$16l=[Ge,Mq,os,Ql,Wi,_m,fb,sf],V.beginPath(),V.lineWidth=1,V.strokeStyle=r,"dashed"===M&&V.setLineDash&&V.setLineDash(l),V.moveTo(Ge.x,Ge.y),V.lineTo(os.x,os.y),V.lineTo(Wi.x,Wi.y),V.lineTo(fb.x,fb.y),V.lineTo(Ge.x,Ge.y),V.stroke(),"dashed"===M&&V.setLineDash&&V.setLineDash([])),V.beginPath(),V.lineWidth=1,V.fillStyle=t,V.strokeStyle=H,Y>0){var cr=Ql.x-sf.x,kk=Ql.y-sf.y,cb=o(cr*cr+kk*kk),nq=Mq.x-_m.x,Zq=Mq.y-_m.y,Qp=o(nq*nq+Zq*Zq),_g=2*L;if(A.isDirectionEditable&&1===np.length){var Ai=np[0],Ln=A.getDataUI(Ai),Qr=Ln._55O,Si=A.isDirectionEditable.bind(A);if(Qr._42O){var Jn,im,ok,yi;Si(Ai,"northwest")&&(Jn=!0,V.rect(Ge.x-Z,Ge.y-Z,L,L)),Si(Ai,"northeast")&&(im=!0,V.rect(os.x-Z,os.y-Z,L,L)),Si(Ai,"southwest")&&(ok=!0,V.rect(fb.x-Z,fb.y-Z,L,L)),Si(Ai,"southeast")&&(yi=!0,V.rect(Wi.x-Z,Wi.y-Z,L,L)),Si(Ai,"north")&&(Jn&&im?cb>_g&&V.rect(Mq.x-Z,Mq.y-Z,L,L):V.rect(Mq.x-Z,Mq.y-Z,L,L)),Si(Ai,"south")&&(yi&&ok?cb>_g&&V.rect(_m.x-Z,_m.y-Z,L,L):V.rect(_m.x-Z,_m.y-Z,L,L)),Si(Ai,"west")&&(ok&&Jn?Qp>_g&&V.rect(sf.x-Z,sf.y-Z,L,L):V.rect(sf.x-Z,sf.y-Z,L,L)),Si(Ai,"east")&&(yi&&im?Qp>_g&&V.rect(Ql.x-Z,Ql.y-Z,L,L):V.rect(Ql.x-Z,Ql.y-Z,L,L))}}else cb>_g&&(V.rect(Mq.x-Z,Mq.y-Z,L,L),V.rect(_m.x-Z,_m.y-Z,L,L)),Qp>_g&&(V.rect(Ql.x-Z,Ql.y-Z,L,L),V.rect(sf.x-Z,sf.y-Z,L,L)),V.rect(Ge.x-Z,Ge.y-Z,L,L),V.rect(os.x-Z,os.y-Z,L,L),V.rect(fb.x-Z,fb.y-Z,L,L),V.rect(Wi.x-Z,Wi.y-Z,L,L)}if(i>0){var Rj=x.$23l=Cr(Mq,0,2*-L,F);V.moveTo(Rj.x+Z,Rj.y),V.arc(Rj.x,Rj.y,Z,0,J,!1)}V.fill(),V.stroke(),x.$40l&&x.$44l(V,b,F);var ub,ui,lb=A.getLeftTopHelpers(),uk=A.getRightTopHelpers(),ig=A.getLeftBottomHelpers(),Cm=A.getRightBottomHelpers(),pc=A.getEdgeHelpers(),ds=A.getEditHelperSize(),cd=ds/2,Ad=function(g,l,r,w){"leftTop"===l?(ub=b.x*y-ds-Z-("h"===w?r*(ds+Z):0)-1,ui=b.y*y-ds-Z-("v"===w?r*(ds+Z):0)-1):"rightTop"===l?(ub=(b.x+b.width)*y+Z+("h"===w?r*(ds+Z):0)+1,ui=b.y*y-ds-Z-("v"===w?r*(ds+Z):0)-1):"leftBottom"===l?(ub=b.x*y-ds-Z-("h"===w?r*(ds+Z):0)-1,ui=(b.y+b.height)*y+Z+("v"===w?r*(ds+Z):0)+1):"rightBottom"===l&&(ub=(b.x+b.width)*y+Z+("h"===w?r*(ds+Z):0)+1,ui=(b.y+b.height)*y+Z+("v"===w?r*(ds+Z):0)+1);var m=ub+cd,W=ui+cd,t=(b.x+b.width/2)*y,z=(b.y+b.height/2)*y,O=Cr({x:t,y:z},m-t,W-z,F);if("host"===g){if(R>0)return x.$77l(V,F,O),!0}else if("edge"===g){if(j>0)return x.$80l(V,F,O),!0}else if("remove"===g){if(_>0)return np&&1===np.length&&np[0]instanceof $?x.$81l(V,F,{x:t+ds/2+5,y:z}):x.$81l(V,F,O),!0}else if("parent"===g){if(S>0)return np&&1===np.length&&np[0]instanceof $?x.$76l(V,F,{x:t-ds/2-5,y:z}):x.$76l(V,F,O),!0}else if("elevation"===g){if(Mh>0)return x.$85l(V,F,O),!0}else if("tall"===g){if(ym>0)return x.$86l(V,F,O),!0}else if("source"===g||"target"===g){var H=np[0],N=A.getDataUI(H),i=me(N,!0),s=i[0],n=i[1];if(kq&&"source"===g)return x.$84l(V,b,s,!0,H.isLooped(),l,r,w),!0;if(wm&&"target"===g)return x.$84l(V,b,n,!1,H.isLooped(),l,r,w),!0}};if(lb&&lb.length>0){var Ib=0;lb.forEach(function(x){Ad(x,"leftTop",Ib,A.getLeftTopHelpersAlign()||"h")&&Ib++})}if(uk&&uk.length>0){var Ib=0;uk.forEach(function(z){Ad(z,"rightTop",Ib,A.getRightTopHelpersAlign()||"h")&&Ib++})}if(ig&&ig.length>0){var Ib=0;ig.forEach(function(z){Ad(z,"leftBottom",Ib,A.getLeftBottomHelpersAlign()||"h")&&Ib++})}if(Cm&&Cm.length>0){var Ib=0;Cm.forEach(function(_){Ad(_,"rightBottom",Ib,A.getRightBottomHelpersAlign()||"h")&&Ib++})}if(pc&&pc.length>0&&((kq||wm)&&np&&1===np.length&&np[0]instanceof $?!0:!1)){var Ib=0;pc.forEach(function(v){Ad(v,"edge",Ib,"h")&&Ib++})}if(x.$72l){var Cj,Yj=x.$67l,vk=x.$68l,no=x.$69l,Dj=(x.$71l,x.$70l),mn=x.$82l,Xq=x.$83l;if(1===Yj?Cj=vk:2===Yj?Cj=no:3===Yj?Cj=Dj:5===Yj?Cj=mn:6===Yj&&(Cj=Xq),Cj){var cq=A.lp(x.$72l),Sn=A.getDataAt(x.$72l);if(Sn&&Sn instanceof U){var Eo,Ee,Gp;if(x.$73l=Sn,1===Yj)if(Sn instanceof Q.Grid)Eo=x.$75l=ss(Sn,cq);else if(Sn instanceof Q.Shape){Gp=x.$74l=_e(Sn,cq);var ch=Sn.getPoints();if(Gp){var ys=Gp.attachIndex,Fh=Yb(Sn,A.getDataUI(Sn),ys)+1,br=Fh+1>=ch.size()?0:Fh+1,pj=ch.get(Fh),tr=ch.get(br),Do=Sn.p(),oi=Sn.getRotation();pj=Cr(Do,pj.x-Do.x,pj.y-Do.y,oi),tr=Cr(Do,tr.x-Do.x,tr.y-Do.y,oi),V.beginPath(),V.strokeStyle=D,V.lineWidth=e,V.moveTo(pj.x*y,pj.y*y),V.lineTo(tr.x*y,tr.y*y),V.stroke()}}Eo?Ee=Eo.rect:(Ee=s.clone(A.getDataUIBounds(Sn)),s.grow(Ee,2)),V.beginPath(),V.rect(Ee.x*y,Ee.y*y,Ee.width*y,Ee.height*y),V.strokeStyle=1===Yj||4===Yj||6===Yj?c:u,V.lineWidth=2,V.setLineDash&&V.setLineDash([8,8]),V.stroke()}else delete x.$73l;cq.x=cq.x*y,cq.y=cq.y*y;var ir=kn(Cj.x,Cj.y,cq.x,cq.y),wi=Cr(Cj,cq.x-Cj.x,cq.y-Cj.y,-ir),of=wi.x-Cj.x;V.translate(Cj.x,Cj.y),V.rotate(ir),q.width=of,q.height=40;var Th=u;(1===Yj||4===Yj||6===Yj)&&(Th=c),q.comps[0].gradientColor=Th,s.drawImage(V,q,0,-20,of,40)}}}if(O.each(function(N){var v=A.getDataUI(N);if(v){var j,M,S=v._55O,l=v._78o;if(S&&S._43O&&N instanceof W?(j=S.$15l,M=N.getSegments(),M&&M.size()||(M=kd(j)),N.isClosePath()&&M.indexOf(5)<0&&(M=new z(M._as),M.add(5))):S&&l&&S._43O&&(j=N.s("edge.points"),M=N.s("edge.segments"),j=Vp(v,j),M&&M.size()||(M=kd(j)),j&&(j=j._as)),j&&M){var L=0,n=M.size(),o=x._hoverSegmentIndex;j=j.slice(0);for(var b=0;b<j.length;b++)j[b]=Yd(j[b],y);V.beginPath(),V.strokeStyle=C,V.lineWidth=1,L=0;for(var b=0;n>b;b++){var k=M.get(b);if(1===k||2===k)L++;else if(3===k){var X=j[L-1],q=j[L],Q=j[L+1];V.moveTo(X.x,X.y),V.lineTo(q.x,q.y),V.lineTo(Q.x,Q.y),L+=2}else if(4===k){var X=j[L-1],r=j[L],O=j[L+1],Q=j[L+2];V.moveTo(X.x,X.y),V.lineTo(r.x,r.y),V.moveTo(O.x,O.y),V.lineTo(Q.x,Q.y),L+=3}}if(V.stroke(),G===N||I===N&&"points"===I.s("edge.type")){V.beginPath(),L=0,V.strokeStyle=D,V.lineWidth=e;for(var b=0;n>b;b++){var k=M.get(b);if(1===k||2===k){if(o===b){var X=j[L-1],Q=j[L];V.moveTo(X.x,X.y),V.lineTo(Q.x,Q.y);break}L++}else if(3===k){if(o===b){var X=j[L-1],q=j[L],Q=j[L+1];V.moveTo(X.x,X.y),V.quadraticCurveTo(q.x,q.y,Q.x,Q.y);break}L+=2}else if(4===k){if(o===b){var X=j[L-1],r=j[L],O=j[L+1],Q=j[L+2];V.moveTo(X.x,X.y),V.bezierCurveTo(r.x,r.y,O.x,O.y,Q.x,Q.y);break}L+=3}else if(5===k&&o===b){var X=j[L-1],Q=j[0];V.moveTo(X.x,X.y),V.lineTo(Q.x,Q.y);break}}V.stroke()}V.beginPath(),L=0,V.strokeStyle=p,V.lineWidth=1,V.fillStyle=P;for(var b=0;n>b;b++){var k=M.get(b);if(1===k||2===k){var Q=j[L];V.moveTo(Q.x+Z,Q.y),V.arc(Q.x,Q.y,Z,0,J,!0),L++}else if(3===k){var Q=j[L+1];V.moveTo(Q.x+Z,Q.y),V.arc(Q.x,Q.y,Z,0,J,!0),L+=2}else if(4===k){var Q=j[L+2];V.moveTo(Q.x+Z,Q.y),V.arc(Q.x,Q.y,Z,0,J,!0),L+=3}}V.fill(),V.stroke(),V.beginPath(),L=0,V.strokeStyle=d,V.lineWidth=1,V.fillStyle=B;for(var b=0;n>b;b++){var k=M.get(b);if(1===k||2===k)L++;else if(3===k){var q=j[L];V.moveTo(q.x+Z,q.y),V.arc(q.x,q.y,Z,0,J,!0),L+=2}else if(4===k){var r=j[L],O=j[L+1];V.moveTo(r.x+Z,r.y),V.arc(r.x,r.y,Z,0,J,!0),V.moveTo(O.x+Z,O.y),V.arc(O.x,O.y,Z,0,J,!0),L+=3}}if(V.fill(),V.stroke(),V.beginPath(),L=0,V.strokeStyle=f,V.lineWidth=2,(G===N||I===N)&&x.$9l!=m){var Q=j[x.$9l];V.moveTo(Q.x+Z,Q.y),V.arc(Q.x,Q.y,Z,0,J,!0),V.stroke()}}}}),x.$87l&&A.sm().contains(x.$87l)){var yf,Le=x.$87l,aq=x.$88l,ds=A.getEditHelperSize(),cd=ds/2;if(A.isHelperEditable(Le,"pointElevation"))if(Le instanceof W){var ck=Le.getPosition();yf=s.clone(Le.getPoints().get(aq)),yf=Cr({x:ck.x,y:ck.y},yf.x-ck.x,yf.y-ck.y,Le.getRotation()),yf.x*=y,yf.y*=y,V.translate(yf.x,yf.y),s.drawImage(V,s.getImage("xeditinteractor_elevationIcon"),cd,-cd,ds,ds),V.translate(-yf.x,-yf.y),x._pointElevationHelperPoint={x:yf.x+ds,y:yf.y}}else if(Le instanceof $){var wj=Vp(A.getDataUI(Le),Le.s("edge.points")),yf=s.clone(wj.get(aq));yf.x*=y,yf.y*=y,V.translate(yf.x,yf.y),s.drawImage(V,s.getImage("xeditinteractor_elevationIcon"),cd,-cd,ds,ds),V.translate(-yf.x,-yf.y),x._pointElevationHelperPoint={x:yf.x+ds,y:yf.y}}}V.restore(),x.$5l=0}},$89l:function(g,B,Q,V){g.save();var k=this,c=k.gv,f=c.getEditHelperSize(),I=f/2;g.beginPath(),g.translate(Q.x,Q.y),g.rotate(B),s.drawImage(g,V,-I,-I,f,f),g.restore()},$85l:function(Z,D,z){var R=this;R.$90l=z,R.$89l(Z,D,z,s.getImage("xeditinteractor_elevationIcon"))},$86l:function(Z,X,C){var v=this;v.$91l=C,v.$89l(Z,X,C,s.getImage("xeditinteractor_tallIcon"))},$77l:function(I,S,r){var V=this;V.$68l=r,V.$89l(I,S,r,s.getImage("xeditinteractor_hostIcon"))},$80l:function(e,d,R){var Q=this;Q.$70l=R,Q.$89l(e,d,R,s.getImage("xeditinteractor_edgeIcon"))},$81l:function(w,W,Q){var u=this;u.$71l=Q,u.$89l(w,W,Q,s.getImage("xeditinteractor_removeIcon"))},$76l:function(I,P,o){var B=this;B.$69l=o,B.$89l(I,P,o,s.getImage("xeditinteractor_parentIcon"))},$84l:function(q,h,B,n,U){var _,m=this,d=m.gv,F=d.getZoom(),V=d.getEditHelperSize(),r=V/2;B.x*=F,B.y*=F,U&&(n?B.x-=r+5:B.x+=r+5),B.y-=V-2,n?(m.$82l=B,_=s.getImage("xeditinteractor_sourceIcon")):(m.$83l=B,_=s.getImage("xeditinteractor_targetIcon")),q.beginPath(),q.translate(B.x,B.y),s.drawImage(q,_,-r,-r,V,V),q.translate(-B.x,-B.y)},$44l:function(s,M,N){s.save();var S=this.gv.getZoom(),j=o(Y(M.width,2)+Y(M.height,2))/2*S+10,D=j,Q=D+8,y=D+18,T=N,u=M.x+M.width/2,b=M.y+M.height/2;s.translate(u*S,b*S),s.beginPath(),s.strokeStyle="rgb(150, 150, 150)";for(var K=0,X=0,B=0,k=0,I=0,L=0;360>L;L++)K=L*C/180,0===L%5&&(X=w(K)*D,B=p(K)*D,k=w(K)*Q,I=p(K)*Q,s.moveTo(X,B),s.lineTo(k,I)),0===L%45&&(X=w(K)*D,B=p(K)*D,k=w(K)*y,I=p(K)*y,s.moveTo(X,B),s.lineTo(k,I));s.stroke(),s.beginPath(),s.rotate(-l),s.beginPath(),s.fillStyle="rgba(255, 0, 0, 0.1)",s.strokeStyle="rgb(157, 157, 157)",s.moveTo(0,0),s.arc(0,0,y,0,N,!1),s.fill(),s.beginPath(),s.moveTo(0+y,0),s.arc(0,0,y,0,N,!1),s.stroke(),s.rotate(l),s.font="bold 12px Verdana, Arial";var n=20*p(T),i=20*w(T),c=x(180*T/C)+"°";s.textAlign="center",s.textBaseline="middle",s.beginPath();var H=s.measureText("365.°").width;s.fillStyle="white",s.rect(n-H/2,-i-10,H,20),s.fill(),s.beginPath(),s.fillStyle="rgb(79,79,79)",s.fillText(c,n,-i),s.restore()}})}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);