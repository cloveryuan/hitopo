!function(k,a,m){"use strict";var Y=k.ht;Y.Astar={},function(x){var B=x();k.AStar=B.astar,k.AStar.Graph=B.Graph}(function(){function y(q){for(var O=q,i=[];O.parent;)i.unshift(O),O=O.parent;return i}function h(){return new X(function(w){return w.f})}function D(z,j){j=j||{},this.nodes=[],this.diagonal=!!j.diagonal,this.grid=[];for(var n=0;n<z.length;n++){this.grid[n]=[];for(var K=0,Z=z[n];K<Z.length;K++){var D=new P(n,K,Z[K]);this.grid[n][K]=D,this.nodes.push(D)}}this.$13x()}function P(F,h,P){this.x=F,this.y=h,this.weight=P}function X(H){this.content=[],this.scoreFunction=H}var W={search:function(j,f,L,F){j.$6x(),F=F||{};var c=F.heuristic;c||(c=j.diagonal?W.$4x.diagonal:W.$4x.manhattan);var T=F.closest||!1,m=F.punish,d=h(),G=f;for(f.h=c(f,L),j.$7x(f),d.push(f);d.size()>0;){var n=d.pop();if(n===L)return y(n);n.closed=!0;for(var V=j.neighbors(n),H=0,R=V.length;R>H;++H){var S=V[H];if(!S.closed&&!S.$9x()){var J=n.g+S.getCost(n,m),C=S.visited;(!C||J<S.g)&&(S.visited=!0,S.parent=n,S.h=S.h||c(S,L),S.g=J,S.f=S.g+S.h,j.$7x(S),T&&(S.h<G.h||S.h===G.h&&S.g<G.g)&&(G=S),C?d.$10x(S):d.push(S))}}}return T?y(G):[]},$4x:{manhattan:function(n,N){var i=Math.abs(N.x-n.x),w=Math.abs(N.y-n.y);return i+w},diagonal:function(S,F){var J=1,N=Math.sqrt(2),w=Math.abs(F.x-S.x),K=Math.abs(F.y-S.y);return J*(w+K)+(N-2*J)*Math.min(w,K)}},$5x:function(e){e.f=0,e.g=0,e.h=0,e.visited=!1,e.closed=!1,e.parent=null}};return D.prototype.$13x=function(){this.dirtyNodes=[];for(var D=0;D<this.nodes.length;D++)W.$5x(this.nodes[D])},D.prototype.$6x=function(){for(var A=0;A<this.dirtyNodes.length;A++)W.$5x(this.dirtyNodes[A]);this.dirtyNodes=[]},D.prototype.$7x=function(q){this.dirtyNodes.push(q)},D.prototype.neighbors=function(z){var Y=[],n=z.x,_=z.y,g=this.grid;return g[n-1]&&g[n-1][_]&&Y.push(g[n-1][_]),g[n+1]&&g[n+1][_]&&Y.push(g[n+1][_]),g[n]&&g[n][_-1]&&Y.push(g[n][_-1]),g[n]&&g[n][_+1]&&Y.push(g[n][_+1]),this.diagonal&&(g[n-1]&&g[n-1][_-1]&&Y.push(g[n-1][_-1]),g[n+1]&&g[n+1][_-1]&&Y.push(g[n+1][_-1]),g[n-1]&&g[n-1][_+1]&&Y.push(g[n-1][_+1]),g[n+1]&&g[n+1][_+1]&&Y.push(g[n+1][_+1])),Y},D.prototype.toString=function(){for(var D=[],W=this.grid,l=0;l<W.length;l++){for(var J=[],I=W[l],j=0;j<I.length;j++)J.push(I[j].weight);D.push(J.join(" "))}return D.join("\n")},P.prototype.toString=function(){return"["+this.x+" "+this.y+"]"},P.prototype.getCost=function(h,l){var O;if(O=h&&h.x!=this.x&&h.y!=this.y?1.41421*this.weight:this.weight,l){var d=h;if(!d)return O;var n=d.parent;return n?Math.abs(n.x+this.x-2*d.x)>1e-5?O+l:Math.abs(n.y+this.y-2*d.y)>1e-5?O+l:O:O}},P.prototype.$9x=function(){return 0===this.weight},X.prototype={push:function(M){this.content.push(M),this.$11x(this.content.length-1)},pop:function(){var b=this.content[0],S=this.content.pop();return this.content.length>0&&(this.content[0]=S,this.$12x(0)),b},remove:function(E){var Y=this.content.indexOf(E),K=this.content.pop();Y!==this.content.length-1&&(this.content[Y]=K,this.scoreFunction(K)<this.scoreFunction(E)?this.$11x(Y):this.$12x(Y))},size:function(){return this.content.length},$10x:function(v){this.$11x(this.content.indexOf(v))},$11x:function(V){for(var d=this.content[V];V>0;){var c=(V+1>>1)-1,f=this.content[c];if(!(this.scoreFunction(d)<this.scoreFunction(f)))break;this.content[c]=d,this.content[V]=f,V=c}},$12x:function(n){for(var o=this.content.length,a=this.content[n],L=this.scoreFunction(a);;){var q,c=n+1<<1,_=c-1,y=null;if(o>_){var H=this.content[_];q=this.scoreFunction(H),L>q&&(y=_)}if(o>c){var b=this.content[c],i=this.scoreFunction(b);(null===y?L:q)>i&&(y=c)}if(null===y)break;this.content[n]=this.content[y],this.content[y]=a,n=y}}},{astar:W,Graph:D}});var Q=Y.Astar.Finder=function(R,w){var S=this;S.gv=R,S.$13x(w),S.refreshMap()};Q.prototype={},Q.prototype.constructor=Q,a.defineProperties(Q.prototype,{_debugInfo:{get:function(){return this.gv._astarDebugInfo},set:function(H){this.gv._astarDebugInfo=H}}}),Q.prototype.$13x=function(C){var e=this,j=e.$14x={};C=C||{};var V=C.gridSize||10;j.gridSizeX=C.gridSizeX||V,j.gridSizeY=C.gridSizeY||V,j.rect=C.rect,j.filter=C.filter,j.extendBlocks=C.extendBlocks||3,j.fastOverlap=C.fastOverlap===m?!0:C.fastOverlap,j.nodeRectExtend=C.nodeRectExtend||0,j.diagonal=C.diagonal===m?!0:C.diagonal,j.turnPunish=C.turnPunish===m?.1:C.turnPunish,j.simplify=C.simplify===m?!0:C.simplify,j.toGridCenter=C.toGridCenter===m?!1:C.toGridCenter,j.closest=C.closest===m?!0:C.closest},Q.prototype.refreshMap=function(){var U,R=this,H=R.$14x,b=H.gridSizeX,q=H.gridSizeY,c=H.extendBlocks;H.rect?U=H.rect:(U=R.$15x(),Y.Default.grow(U,b*c,q*c)),Y.Default.grow(U,b,q);var d=Math.floor(U.x/b)*b,z=Math.floor(U.y/q)*q,m=Math.ceil(U.width/b),D=Math.ceil(U.height/q),i=m*b,j=D*q;R.$16x={x:d,y:z,w:i,h:j,gridX:b,gridY:q,xLen:m,yLen:D},R.$17x(),R.$21x()},Q.prototype.$15x=function(){var L=this.gv;if(L instanceof Y.graph.GraphView)return L.getContentRect();var p,J=Y.Default.unionRect;return L.dm().each(function(O){L.isVisible(O)&&O.getRect&&(p=J(p,O.getRect()))}),p},Q.prototype.$17x=function(){var _,v,t,Z,k=this,L=k.$16x,M=L.xLen,V=L.yLen;for(_=new Array(M),t=0;M>t;t++)for(_[t]=v=new Array(V),Z=V;Z--;)v[Z]=1;var x=k.$14x.filter;for(k.gv.dm().each(function(u){x&&x(u)===!1||(!k._debugInfo||u!==k._debugInfo.grid&&u!=k._debugInfo.path)&&k.$1cw(_,u)}),t=0;M>t;t++)_[t][0]=1,_[t][V-1]=1;for(Z=0;V>Z;Z++)_[0][Z]=1,_[M-1][Z]=1;k.grid=_;var w=new AStar.Graph(_,{diagonal:k.$14x.diagonal});k.graph=w},Q.prototype.$18x=function(t,s,D,e,J,Z,F,U){var V=this.$19x,X=V(D-t,J-F,e-s,Z-U);if(1e-6>=X&&X>=-1e-6)return!1;var w=V(J-t,J-F,Z-s,Z-U)/X;if(0>w||w>1)return!1;var v=V(D-t,J-t,e-s,Z-s)/X;return 0>v||v>1?!1:!0},Q.prototype.$19x=function(k,P,a,Y){return k*Y-P*a},Q.prototype.$1aw=function(l,F,p,J){for(var i=[-(F[1]-l[1]),F[0]-l[0]],o=i[0]*(p[0]-l[0])+i[1]*(p[1]-l[1])>=0,$=0,n=J.length;n>$;$+=2)if(i[0]*(J[$]-l[0])+i[1]*(J[$+1]-l[1])>=0===o)return!1;return!0},Q.prototype.$1bw=function(x,f){for(var b,U,Z=this,q=0,_=x.length;_>q;q+=2)if(b=q===_-2?0:q+2,U=b===_-2?0:b+2,Z.$1aw([x[q],x[q+1]],[x[b],x[b+1]],[x[U],x[U+1]],f))return!1;for(var q=0,_=f.length;_>q;q+=2)if(b=q===_-2?0:q+2,U=b===_-2?0:b+2,Z.$1aw([f[q],f[q+1]],[f[b],f[b+1]],[f[U],f[U+1]],x))return!1;return!0},Q.prototype.$1cw=function(j,i){if(i.getRect){var o=this,u=i.getRect();Y.Default.grow(u,o.$14x.nodeRectExtend);var k,K,v,s,Q,Z,J,d,w,g,N,L=o.$1dw({x:u.x,y:u.y}),r=o.$1dw({x:u.x+u.width,y:u.y+u.height}),p=o.$14x.fastOverlap;if(!p){var z=i.getCorners();J=[],z.forEach(function($){J.push($.x,$.y)}),g=o.$14x.gridSizeX/2,N=o.$14x.gridSizeY/2}for(K=Math.max(0,L.x),v=Math.min(r.x,j.length-1),Q=Math.max(0,L.y),Z=Math.min(r.y,j.length?j[0].length-1:-1),k=K;v>=k;k++)for(s=Q;Z>=s;s++)if(p)j[k][s]=0;else{w=o.$1ew({x:k,y:s});var m=w.x-g,E=w.x+g,M=w.y-N,V=w.y+N;d=[m,M,m,V,E,V,E,M],o.$1bw(J,d)&&(j[k][s]=0)}}},Q.prototype.$1dw=function(n,Y){var g=this,_=g.$16x,N=(n.x-_.x)/_.gridX,h=(n.y-_.y)/_.gridY;return Y!==!1&&(N=Math.round(N),h=Math.round(h)),{x:N,y:h}},Q.prototype.$1ew=function(O){var v=this,g=v.$16x;return{x:O.x*g.gridX+g.x,y:O.y*g.gridY+g.y}},Q.prototype.$1fw=function(c){var u=this,l=u.$16x,v=l.xLen,e=l.yLen;if(c.x>=0&&c.x<v&&c.y>=0&&c.y<e)return c;var S={x:c.x,y:c.y};return S.x<0?S.x=0:S.x>=v&&(S.x=v-1),S.y<0?S.y=0:S.y>=e&&(S.y=e-1),S},Q.prototype.findPath=function(e,g){var S,F,X,B,H=this,Z=H.$1dw(e),q=H.$1dw(g);if(X=H.$1fw(Z),B=H.$1fw(q),X!==Z&&B!==q){var L=H.$16x,l=L.x-L.gridX/2,I=L.y-L.gridY/2,O=l+L.gridX*L.xLen,m=I+L.gridY*L.yLen;if(!(H.$18x(e.x,e.y,g.x,g.y,l,I,O,I)||H.$18x(e.x,e.y,g.x,g.y,O,I,O,m)||H.$18x(e.x,e.y,g.x,g.y,O,m,l,m)||H.$18x(e.x,e.y,g.x,g.y,l,m,l,I)))return[e,g]}X!==Z&&(S=!0,Z=X),B!==q&&(F=!0,q=B);var v=H.graph.grid[Z.x][Z.y],R=H.graph.grid[q.x][q.y],T=AStar.search(H.graph,v,R,{closest:H.$14x.closest,punish:H.$14x.turnPunish});if(!T||!T.length)return null;var Y=[];Y.push(e),S&&Y.push(H.$1ew(T[0]));for(var k=1,h=T.length;h-1>k;k++)Y.push(H.$1ew(T[k]));if(F)Y.push(H.$1ew(T[h-1])),Y.push(g);else{var f=T[h-1];q.x!==f.x||q.y!==f.y||H.$14x.toGridCenter?Y.push(H.$1ew(f)):Y.push(g)}return H.$14x.simplify&&(Y=H.simplifyPath(Y)),H.$20x=Y,H.$21x(),Y},Q.prototype.debugOn=function(r){this.debugFlag=!0,this.debugSettings=r||{},this.$21x()},Q.prototype.simplifyPath=function(j){var b=j.length;if(2>=b)return j;var L,A,h=[j[0],j[1]],Y=h[0],I=h[1],D=1e-5;for(L=2;b>L;L++)A=j[L],Math.abs((I.x-Y.x)*(A.y-Y.y)-(I.y-Y.y)*(A.x-Y.x))<D?I=h[h.length-1]=A:(Y=I,I=A,h.push(A));return h},Q.prototype.$21x=function(){var E=this;if(E.$22x(),this.debugFlag){var $=E.grid;if($){var Z,I=E.gv;if(E.debugSettings.$16x!==!1){Z=[];for(var Q,K,N,S,r,z=[],n=E.$14x.gridSizeX/2,O=E.$14x.gridSizeY/2,B=$.length,o=B?$[0].length:0,m=1;B-1>m;m++)for(var v=1;o-1>v;v++)$[m][v]||(Q=E.$1ew({x:m,y:v}),K=Q.x-n,N=Q.x+n,S=Q.y-O,r=Q.y+O,Z.push({x:K,y:S},{x:K,y:r},{x:N,y:r},{x:N,y:S}),z.push(1,2,2,2,5));var _=new Y.Shape;_.s("shape.border.color","rgba(50, 50, 50, 0.2)"),_.s("shape.border.width",1),_.s("shape.background","rgba(200, 50, 100, 0.2)"),_.s("2d.editable",!1),_.s("2d.selectable",!1),_.setPoints(Z),_.setSegments(z),E._debugInfo={grid:_},I.dm().add(_)}E.debugSettings.path!==!1&&(Z=new Y.Shape,E.$20x&&(Z.setPoints(E.$20x),Z.s("shape.border.color","red"),Z.s("shape.border.width",1),Z.s("2d.editable",!1),Z.s("2d.selectable",!1),Z.s("shape.background",null),E._debugInfo||(E._debugInfo={}),E._debugInfo.path=Z,I.dm().add(Z)))}}},Q.prototype.debugOff=function(){this.debugFlag=!1,this.$22x()},Q.prototype.$22x=function(){var y=this;if(y._debugInfo){var R=y._debugInfo.grid,x=y._debugInfo.path,s=y.gv;R&&s.dm().remove(R),x&&s.dm().remove(x),y._debugInfo=null}}}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);